var listExtras="",reciboReset={id_pago:0,id_contrato:0,id_servicio:0,id_empleado:0,fecha_pago:"",concepto:"extra",detalles_extra:"",cuota:"",mora:"",monto_extra:"",total:"",estado:"",fecha_limite:"",complete_date:"",descuento:"",razon_descuento:"",deuda:"",abono_a:"",tipo:"",generado:""},appPagoExtra=new Vue({el:"#app-pago-extra",data:{recibo:{id_pago:0,id_contrato:0,id_servicio:0,id_empleado:0,fecha_pago:"dd/mm/yyyy",concepto:"extra",detalles_extra:"",cuota:"",mora:"",monto_extra:"",total:"",estado:"",fecha_limite:"",complete_date:"",descuento:"",razon_descuento:"",deuda:"",abono_a:"",tipo:"",generado:""},visible:!1,extra:{controls:"",id_extra:"",id_servicio:"",checkbox:"",fecha:"",concepto:"",ultimo_pago:"",monto_pagado:"",monto_total:"",estado:""},firstControls:{hide:!1}},filters:{},computed:{url_recibo:function(){return BASE_URL+"process/getrecibo/"+this.recibo.id_pago},hide_recibo:function(){return"pagado"!=this.recibo.estado&&(this.hide_recibo=!0)}},methods:{goBack:function(){extraTable.el.parents(".bootstrap-table").removeClass("hide"),this.visible=!1,this.extra={concepto:""},extraTable.refresh(listExtras)},generatePayment:function(){var t="data="+JSON.stringify(this.extra),a=axios.post(BASE_URL+"extra/generate_extra_payment",t);a.then(function(t){var a=t.data;displayMessage(a.mensaje),selectExtraPayment.html(a.pagos).change()}),a.catch(function(){})},getPayment:function(t){var a="data="+JSON.stringify({id_pago:t}),e=this;axios.post(BASE_URL+"extra/get_payment",a).then(function(t){var a=t.data;a.recibo&&(e.recibo=a.recibo)})},applyPayment:function(){var t=this,a=this.recibo,e={id_extra:a.id_extra,id_pago:a.id_pago},o={concepto:"extra -",detalles_extra:a.detalles_extra,fecha_pago:a.fecha_pago,cuota:a.cuota,total:a.cuota,estado:"pagado",tipo:a.tipo,generado:!0},i="data="+JSON.stringify(o)+"&info="+JSON.stringify(e),r=axios.post(BASE_URL+"extra/apply_payment",i);r.then(function(a){var e=a.data;listExtras=e.extras,t.getPayments(t.extra.id_extra),displayMessage(e.mensaje)}),r.catch(function(t){console.log(t)})},getPayments:function(t){var a=this,e="data="+JSON.stringify({id_extra:t});axios.post(BASE_URL+"extra/get_extra_payment_of",e).then(function(t){var e=t.data;e.pagos||(a.recibo=reciboReset),selectExtraPayment.html(e.pagos).change()})},deletePayment:function(){var t=this,a=this.recibo,e={id_extra:a.id_extra,id_pago:a.id_pago},o="data="+JSON.stringify(e),i=axios.post(BASE_URL+"extra/delete_payment",o);i.then(function(a){var e=a.data;displayMessage(e.mensaje),t.getPayments(t.extra.id_extra)}),i.catch(function(t){console.log(t)})}}});bus.$on("row-selected",function(t){extraTable.el.parents(".bootstrap-table").addClass("hide"),appPagoExtra.visible=!0,appPagoExtra.extra=t,listExtras=extraTable.el.find("tbody").html(),appPagoExtra.getPayments(t.id_extra)});var selectExtraPayment=$("#select-extra-payment");selectExtraPayment.on("change",function(){var t=selectExtraPayment.val();appPagoExtra.getPayment(t)});