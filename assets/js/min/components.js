function fillBSTable(e,t){var a=$(e);a.bootstrapTable("destroy"),a.find("tbody").html(t),a.bootstrapTable(),$(".pull-right.search").addClass("hide"),a.find("tbody").css({display:"table-row-group"}),a.addClass("innertable")}function filterBSTable(e,t){$(e).bootstrapTable("filterBy",{estado:t})}function getForm(e){return"data="+JSON.stringify(e)}var closeReport=new Vue({el:"#cierres",data:{table:"",tableHTML:"",hasTotals:!1,totals:!1,between:{first_date:"",second_date:"",text:""}},mounted:function(){"informes"==currentPage&&this.getReport()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"caja/get_cierres/true",t).then(function(t){e.fillTable(t.data.content),e.hasTotals=!0,e.totals=t.data.acum})},fillTable:function(e){fillBSTable("#cierres-table",e)}}}),expensesReport=new Vue({el:"#gastos",data:{table:"",tableHTML:"",total:"",between:{first_date:"",second_date:"",text:""}},mounted:function(){"informes"==currentPage&&this.getReport()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"caja/get_gastos/true",t).then(function(t){e.fillTable(t.data.content),e.total=t.data.acum})},fillTable:function(e){fillBSTable("#gastos-table",e)}}}),extraSection=new Vue({el:"#extra-section",data:{content:"",search:{text:"",state:"activo"},totales:{pagado:0,pendiente:0,total_vendido:0},tableId:"#extra-table-full"},mounted:function(){"extras"==currentPage&&this.getData()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{filter:function(e){filterBSTable(this.tableId,this.filterValue)},getData:function(){var e=this,t="data="+JSON.stringify(this.search);axios.post(BASE_URL+"extra/get_all",t).then(function(t){e.fillTable(t.data.content),e.totales=t.data.totales})},fillTable:function(e){fillBSTable("#extra-table-full",e)}}}),configMessage={email:"",password:"",device_id:"",country_code:"",send_at:"1 second",expires_at:"1 hour"},configMessagesForm=new Vue({el:"#message-settings-section",data:{config:configMessage},mounted:function(){this.getConfig()},methods:{confirmPhone:function(){},getConfig:function(){var e,t=this;(e=axios.get(BASE_URL+"messages/get_config")).then(function(e){e.data.config&&(t.config=e.data.config)}),e.catch(function(e){console.log(e)})},saveSettings:function(e){var t,a,i;t=this.config,a="data="+JSON.stringify(t),(i=axios.post(BASE_URL+"messages/save_config",a)).then(function(e){displayMessage(e.data.mensaje)}),i.catch(function(e){console.log(e)})}}}),sendMessageApp=new Vue({el:"#send-message-modal",data:{hide_clients:!0,hide_numbers:!0,message_data:{tipo:"",clientes:"",numeros:"",mensaje:""}},mounted:function(){this.initSelect2()},computed:{letters_count:function(){return this.message_data.mensaje.length}},methods:{sendMessage:function(){var e,t;isEmpty([this.message_data.tipo,this.message_data.mensaje])?swal("Campos Requeridos","Por favor selecciones el tipo de mensaje y escriba su mensaje"):(e="data="+JSON.stringify(this.message_data),(t=axios.post(BASE_URL+"messages/send_message",e)).then(function(e){displayMessage(e.data.mensaje)}),t.catch(function(e){console.log(e)}))},initSelect2:function(){var e={dropdownParent:$("#send-message-modal")},t=$("#message-type");t.select2(e);var a={clients:$("#clients-for-message").select2({dropdownParent:$("#send-message-modal"),ajax:{url:BASE_URL+"messages/search_clients",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e.items,pagination:{more:30*t.page<e.total_count}}},cache:!0}}),messageType:t};this.selec2Liteners(a)},selec2Liteners:function(e){var t=this;e.messageType.on("select2:select",function(e){e.params.data.element.attributes;var a=e.params.data.id;t.message_data.tipo=a,"otros"==a?(t.hide_clients=!0,t.hide_numbers=!1):"personalizado"==a?(t.hide_numbers=!0,t.hide_clients=!1):(t.hide_clients=!0,t.hide_numbers=!0)}),e.messageType.select2("val","mora"),e.clients.on("select2:select",function(a){for(var i=e.clients.select2("data"),n=[],s=0;s<i.length;s++)n.push({nombre_completo:i[s].text,celular:i[s].id});t.message_data.clientes=n})}}}),paymentsReport=new Vue({el:"#recibos",data:{table:"",tableHTML:"",total:"",between:{first_date:"",second_date:"",text:""}},mounted:function(){"notificaciones"==currentPage&&this.getReport()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"payment/get_receipts/",t).then(function(t){e.fillTable(t.data.content),e.total=t.data.acum})},fillTable:function(e){var t=$("#receipts-table");t.bootstrapTable("destroy"),t.find("tbody").html(e),t.bootstrapTable(),t.find("tbody").css({display:"table-row-group"})}}}),RetirementReport=new Vue({el:"#retiros",data:{table:"",tableHTML:"",between:{first_date:"",second_date:""}},mounted:function(){"notificaciones"==currentPage&&this.getReport()},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"contract/getCancelations/",t).then(function(t){e.fillTable(t.data.content)})},fillTable:function(e){var t=$("#cancelation-table");t.bootstrapTable("destroy"),t.find("tbody").html(e),t.bootstrapTable(),t.find("tbody").css({display:"table-row-group"})}}}),ticketListView=new Vue({el:"#averias-list-view",data:{dataSearch:{text:"",state:"por reparar"},tickets:[],hide:!1},mounted:function(){this.itemClickListener();var e=this;busAveria.$on("tickets-listed",function(){e.itemClickListener()})},methods:{search:function(){var e="data="+JSON.stringify(this.dataSearch),t=axios.post(BASE_URL+"api/averias/search",e);t.then(function(e){this.fillAveriasList(e.data)}),t.catch(function(){console.error(res.data.mensaje)})},fillAveriasList:function(e){$("#averia-item-list").html(e),ticketListView.itemClickListener()},itemClickListener:function(){$("#averias-list-view .averia-item").on("click",function(){var e=$(this).find(".code").text().trim();ticketView.getTicket(e)})}}}),emptyTicket={id_averia:"",id_cliente:"",cliente:"",direccion:"",descripcion:"",celular:"",fecha:"",estado:"",fecha_reparacion:"",tecnico:"",codigo:""},ticketView=new Vue({el:"#ticket-view",data:{classes:{hide:!0},mode:{newComment:!1,edit:!1},new_comment:"",comments:[],ticket:emptyTicket},created:function(){$("#ticket-view").removeClass("invisible")},methods:{getTicket:function(e){var t="data="+JSON.stringify({id_averia:e});axios.post(BASE_URL+"api/averias/get_averia",t).then(function(e){var t=e.data;ticketView.classes.hide=!1,ticketListView.hide=!0,ticketView.ticket=t.ticket,ticketView.comments=t.comments})},quit:function(){this.ticket=emptyTicket,this.comments=null,this.classes.hide=!0,this.closeCommentMode(),ticketListView.hide=!1},print:function(){print()},startComment:function(){this.mode.newComment=!0},addComment:function(){var e=getForm({id_averia:this.ticket.id_averia,descripcion:this.new_comment}),t=this;axios.post(BASE_URL+"api/averias/add_comment",e).then(function(e){t.getComments(),t.closeCommentMode(),displayMessage(e.data.mensaje)})},_deleteComment:function(e){var t=e.target.parentNode.parentNode,a=e.target.parentNode.attributes["data-id"].value,i=this;t.classList.add("to-delete"),swal({title:"EstÃ¡ Seguro?",text:"Seguro de que eliminar este reporte?",type:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(function(){i.deleteComment(a),t.classList.remove("to-delete")}).catch(function(){t.classList.remove("to-delete")})},deleteComment:function(e){var t=this,a=getForm({id_reporte:e});axios.post(BASE_URL+"api/averias/delete_comment",a).then(function(e){t.getComments(),displayMessage(e.data.mensaje)})},editComment:function(){},closeCommentMode:function(){this.mode.newComment=!1,this.new_comment=""},getComments:function(){var e=getForm({id_averia:this.ticket.id_averia}),t=this;axios.post(BASE_URL+"api/averias/get_comments",e).then(function(e){t.comments=e.data.comments})},updateDescription:function(){this.updateTicket(["id_averia","descripcion","tecnico","estado","fecha_reparacion"])},updateState:function(){"por reparar"==this.ticket.estado?this.ticket.fecha_reparacion="":this.ticket.fecha_reparacion=moment().format("YYYY-MM-DD")},updateTicket:function(e){this.closeEditMode();var t=getForm(this.getFields(e));axios.post(BASE_URL+"api/averias/update_averia",t).then(function(e){ticketListView.search(),displayMessage(e.data.mensaje)})},deleteTicket:function(){console.info("deleted")},closeEditMode:function(){this.mode.edit=!1},enterEditMode:function(){this.mode.edit=!0},getFields:function(e){var t={},a=this;return e.forEach(function(e){t[e]=a.ticket[e]},this),t}}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkEtTGliLmpzIiwiVGlja2V0cy5qcyIsImNsb3NlUmVwb3J0LjEuanMiLCJFeHBlbnNlc1JlcG9ydC5qcyIsIkV4dHJhU2VjdGlvbi5qcyIsIk1lc3NhZ2VzLmpzIiwiUGF5bWVudHMuanMiLCJSZXRpcmVtZW50cy5qcyJdLCJuYW1lcyI6WyJmaWxsQlNUYWJsZSIsInRhYmxlSWQiLCJjb250ZW50IiwiJHRhYmxlIiwiJCIsImJvb3RzdHJhcFRhYmxlIiwiZmluZCIsImh0bWwiLCJhZGRDbGFzcyIsImNzcyIsImRpc3BsYXkiLCJmaWx0ZXJCU1RhYmxlIiwic3RhdGUiLCJlc3RhZG8iLCJnZXRGb3JtIiwib2JqZWN0IiwiSlNPTiIsInN0cmluZ2lmeSIsImNsb3NlUmVwb3J0IiwiVnVlIiwiZWwiLCJkYXRhIiwidGFibGUiLCJ0YWJsZUhUTUwiLCJoYXNUb3RhbHMiLCJ0b3RhbHMiLCJiZXR3ZWVuIiwiZmlyc3RfZGF0ZSIsInNlY29uZF9kYXRlIiwidGV4dCIsIm1vdW50ZWQiLCJjdXJyZW50UGFnZSIsInRoaXMiLCJnZXRSZXBvcnQiLCJmaWx0ZXJzIiwiY3VycmVuY3lGb3JtYXQiLCJudW1iZXIiLCJDdXJyZW5jeUZvcm1hdCIsIm1ldGhvZHMiLCJzZWxmIiwiZm9ybSIsImF4aW9zIiwicG9zdCIsIkJBU0VfVVJMIiwidGhlbiIsInJlcyIsImZpbGxUYWJsZSIsImFjdW0iLCJleHBlbnNlc1JlcG9ydCIsInRvdGFsIiwiZXh0cmFTZWN0aW9uIiwic2VhcmNoIiwidG90YWxlcyIsInBhZ2FkbyIsInBlbmRpZW50ZSIsInRvdGFsX3ZlbmRpZG8iLCJnZXREYXRhIiwiZmlsdGVyIiwiZSIsImZpbHRlclZhbHVlIiwiY29uZmlnTWVzc2FnZSIsImVtYWlsIiwicGFzc3dvcmQiLCJkZXZpY2VfaWQiLCJjb3VudHJ5X2NvZGUiLCJzZW5kX2F0IiwiZXhwaXJlc19hdCIsImNvbmZpZ01lc3NhZ2VzRm9ybSIsImNvbmZpZyIsImdldENvbmZpZyIsImNvbmZpcm1QaG9uZSIsInNlbmQiLCJnZXQiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInNhdmVTZXR0aW5ncyIsImRpc3BsYXlNZXNzYWdlIiwibWVuc2FqZSIsImVyciIsInNlbmRNZXNzYWdlQXBwIiwiaGlkZV9jbGllbnRzIiwiaGlkZV9udW1iZXJzIiwibWVzc2FnZV9kYXRhIiwidGlwbyIsImNsaWVudGVzIiwibnVtZXJvcyIsImluaXRTZWxlY3QyIiwiY29tcHV0ZWQiLCJsZXR0ZXJzX2NvdW50IiwibGVuZ3RoIiwic2VuZE1lc3NhZ2UiLCJpc0VtcHR5Iiwic3dhbCIsIm9wdGlvbnMiLCJkcm9wZG93blBhcmVudCIsInNlbGVjdE1lc3NhZ2VUeXBlIiwic2VsZWN0MiIsInNlbGVjdHMiLCJjbGllbnRzIiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwiZGVsYXkiLCJwYXJhbXMiLCJxIiwidGVybSIsInBhZ2UiLCJwcm9jZXNzUmVzdWx0cyIsInJlc3VsdHMiLCJpdGVtcyIsInBhZ2luYXRpb24iLCJtb3JlIiwidG90YWxfY291bnQiLCJjYWNoZSIsIm1lc3NhZ2VUeXBlIiwic2VsZWMyTGl0ZW5lcnMiLCJvbiIsImVsZW1lbnQiLCJhdHRyaWJ1dGVzIiwiaWQiLCJpIiwicHVzaCIsIm5vbWJyZV9jb21wbGV0byIsImNlbHVsYXIiLCJwYXltZW50c1JlcG9ydCIsIlJldGlyZW1lbnRSZXBvcnQiLCJ0aWNrZXRMaXN0VmlldyIsImRhdGFTZWFyY2giLCJ0aWNrZXRzIiwiaGlkZSIsIml0ZW1DbGlja0xpc3RlbmVyIiwiYnVzQXZlcmlhIiwiJG9uIiwiZmlsbEF2ZXJpYXNMaXN0IiwiJGNvbnRlbnQiLCJpZF9hdmVyaWEiLCJ0cmltIiwidGlja2V0VmlldyIsImdldFRpY2tldCIsImVtcHR5VGlja2V0IiwiaWRfY2xpZW50ZSIsImNsaWVudGUiLCJkaXJlY2Npb24iLCJkZXNjcmlwY2lvbiIsImZlY2hhIiwiZmVjaGFfcmVwYXJhY2lvbiIsInRlY25pY28iLCJjb2RpZ28iLCJjbGFzc2VzIiwibW9kZSIsIm5ld0NvbW1lbnQiLCJlZGl0IiwibmV3X2NvbW1lbnQiLCJjb21tZW50cyIsInRpY2tldCIsImNyZWF0ZWQiLCJyZW1vdmVDbGFzcyIsInF1aXQiLCJjbG9zZUNvbW1lbnRNb2RlIiwicHJpbnQiLCJzdGFydENvbW1lbnQiLCJhZGRDb21tZW50IiwiZ2V0Q29tbWVudHMiLCJfZGVsZXRlQ29tbWVudCIsImNvbW1lbnRJdGVtIiwidGFyZ2V0IiwicGFyZW50Tm9kZSIsImlkQ29tbWVudCIsInZhbHVlIiwiY2xhc3NMaXN0IiwiYWRkIiwidGl0bGUiLCJ0eXBlIiwic2hvd0NhbmNlbEJ1dHRvbiIsImNvbmZpcm1CdXR0b25UZXh0IiwiY2FuY2VsQnV0dG9uVGV4dCIsImRlbGV0ZUNvbW1lbnQiLCJyZW1vdmUiLCJpZF9yZXBvcnRlIiwiZWRpdENvbW1lbnQiLCJ1cGRhdGVEZXNjcmlwdGlvbiIsInVwZGF0ZVRpY2tldCIsInVwZGF0ZVN0YXRlIiwibW9tZW50IiwiZm9ybWF0IiwiZmllbGRzIiwiY2xvc2VFZGl0TW9kZSIsImdldEZpZWxkcyIsImRlbGV0ZVRpY2tldCIsImluZm8iLCJlbnRlckVkaXRNb2RlIiwic2VsZWN0ZWRGaWVsZHMiLCJmb3JFYWNoIiwiZmllbGQiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLFlBQUFDLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQUMsRUFBQUgsR0FDQUUsRUFBQUUsZUFBQSxXQUNBRixFQUFBRyxLQUFBLFNBQUFDLEtBQUFMLEdBQ0FDLEVBQUFFLGlCQUNBRCxFQUFBLHNCQUFBSSxTQUFBLFFBQ0FMLEVBQUFHLEtBQUEsU0FBQUcsS0FBQUMsUUFBQSxvQkFDQVAsRUFBQUssU0FBQSxjQUlBLFNBQUFHLGNBQUFWLEVBQUFXLEdBQ0FSLEVBQUFILEdBQUFJLGVBQUEsWUFDQVEsT0FBQUQsSUNtTkEsU0FBQUUsUUFBQUMsR0FDQSxNQUFBLFFBQUFDLEtBQUFDLFVBQUFGLEdDak9BLElBQUFHLFlBQUEsSUFBQUMsS0FDQUMsR0FBQSxXQUNBQyxNQUNBQyxNQUFB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QXRKLEtBQUF1SixjQUFBLFlBQUEsY0FBQSxVQUFBLFNBQUEsc0JBR0FDLFlBQUEsV0FDQSxlQUFBeEosS0FBQTRILE9BQUEvSSxPQUNBbUIsS0FBQTRILE9BQUFULGlCQUFBLEdBRUFuSCxLQUFBNEgsT0FBQVQsaUJBQUFzQyxTQUFBQyxPQUFBLGVBSUFILGFBQUEsU0FBQUksR0FDQTNKLEtBQUE0SixnQkFDQSxJQUFBcEosRUFBQTFCLFFBQUFrQixLQUFBNkosVUFBQUYsSUFDQWxKLE1BQUFDLEtBQUFDLFNBQUEsNEJBQUFILEdBRUFJLEtBQUEsU0FBQUMsR0FDQW1GLGVBQUE3RSxTQUNBMkIsZUFBQWpDLEVBQUF4QixLQUFBMEQsWUFJQStHLGFBQUEsV0FDQW5ILFFBQUFvSCxLQUFBLFlBR0FILGNBQUEsV0FDQTVKLEtBQUF1SCxLQUFBRSxNQUFBLEdBR0F1QyxjQUFBLFdBQ0FoSyxLQUFBdUgsS0FBQUUsTUFBQSxHQUdBb0MsVUFBQSxTQUFBRixHQUNBLElBQUFNLEtBQ0ExSixFQUFBUCxLQUtBLE9BSkEySixFQUFBTyxRQUFBLFNBQUFDLEdBQ0FGLEVBQUFFLEdBQUE1SixFQUFBcUgsT0FBQXVDLElBQ0FuSyxNQUVBaUsiLCJmaWxlIjoiY29tcG9uZW50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGZpbGxCU1RhYmxlKHRhYmxlSWQsIGNvbnRlbnQpIHtcclxuICB2YXIgJHRhYmxlID0gJCh0YWJsZUlkKTtcclxuICAkdGFibGUuYm9vdHN0cmFwVGFibGUoJ2Rlc3Ryb3knKTtcclxuICAkdGFibGUuZmluZCgndGJvZHknKS5odG1sKGNvbnRlbnQpO1xyXG4gICR0YWJsZS5ib290c3RyYXBUYWJsZSgpO1xyXG4gICQoJy5wdWxsLXJpZ2h0LnNlYXJjaCcpLmFkZENsYXNzKCdoaWRlJylcclxuICAkdGFibGUuZmluZCgndGJvZHknKS5jc3Moe2Rpc3BsYXk6XCJ0YWJsZS1yb3ctZ3JvdXBcIn0pO1xyXG4gICR0YWJsZS5hZGRDbGFzcygnaW5uZXJ0YWJsZScpO1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gZmlsdGVyQlNUYWJsZSh0YWJsZUlkLHN0YXRlKSB7XHJcbiAgJCh0YWJsZUlkKS5ib290c3RyYXBUYWJsZSgnZmlsdGVyQnknLHtcclxuICAgIGVzdGFkbzogc3RhdGVcclxuICB9KTtcclxufSIsIiAgdmFyIHRpY2tldExpc3RWaWV3ID0gbmV3IFZ1ZSh7XHJcbiAgICBlbDogJyNhdmVyaWFzLWxpc3QtdmlldycsXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgIGRhdGFTZWFyY2g6IHtcclxuICAgICAgICB0ZXh0OiAnJyxcclxuICAgICAgICBzdGF0ZTogJ3BvciByZXBhcmFyJyxcclxuICAgICAgfSxcclxuICAgICAgdGlja2V0czogW10sXHJcbiAgICAgIGhpZGU6IGZhbHNlXHJcbiAgICB9LFxyXG5cclxuICAgIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5pdGVtQ2xpY2tMaXN0ZW5lcigpO1xyXG4gICAgICB2YXIgc2VsZiA9IHRoaXNcclxuICAgICAgYnVzQXZlcmlhLiRvbigndGlja2V0cy1saXN0ZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5pdGVtQ2xpY2tMaXN0ZW5lcigpXHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgIHNlYXJjaDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmb3JtID0gJ2RhdGE9JyArIEpTT04uc3RyaW5naWZ5KHRoaXMuZGF0YVNlYXJjaCk7XHJcbiAgICAgICAgdmFyIHNlbmQgPSBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ2FwaS9hdmVyaWFzL3NlYXJjaCcsIGZvcm0pO1xyXG5cclxuICAgICAgICBzZW5kLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgdGhpcy5maWxsQXZlcmlhc0xpc3QocmVzLmRhdGEpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHNlbmQuY2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihyZXMuZGF0YS5tZW5zYWplKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgfSxcclxuXHJcbiAgICAgIGZpbGxBdmVyaWFzTGlzdDogZnVuY3Rpb24gKCRjb250ZW50KSB7XHJcbiAgICAgICAgJCgnI2F2ZXJpYS1pdGVtLWxpc3QnKS5odG1sKCRjb250ZW50KTtcclxuICAgICAgICB0aWNrZXRMaXN0Vmlldy5pdGVtQ2xpY2tMaXN0ZW5lcigpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgaXRlbUNsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKCcjYXZlcmlhcy1saXN0LXZpZXcgLmF2ZXJpYS1pdGVtJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgdmFyIGlkX2F2ZXJpYSA9ICQodGhpcykuZmluZCgnLmNvZGUnKS50ZXh0KCkudHJpbSgpO1xyXG4gICAgICAgICAgdGlja2V0Vmlldy5nZXRUaWNrZXQoaWRfYXZlcmlhKTtcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHZhciBlbXB0eVRpY2tldCA9IHtcclxuICAgIFwiaWRfYXZlcmlhXCI6IFwiXCIsXHJcbiAgICBcImlkX2NsaWVudGVcIjogXCJcIixcclxuICAgIFwiY2xpZW50ZVwiOiBcIlwiLFxyXG4gICAgXCJkaXJlY2Npb25cIjogXCJcIixcclxuICAgIFwiZGVzY3JpcGNpb25cIjogXCJcIixcclxuICAgIFwiY2VsdWxhclwiOiBcIlwiLFxyXG4gICAgXCJmZWNoYVwiOiBcIlwiLFxyXG4gICAgXCJlc3RhZG9cIjogXCJcIixcclxuICAgIFwiZmVjaGFfcmVwYXJhY2lvblwiOiBcIlwiLFxyXG4gICAgXCJ0ZWNuaWNvXCI6IFwiXCIsXHJcbiAgICBcImNvZGlnb1wiOiAnJyxcclxuICB9XHJcbiAgXHJcbiAgdmFyIHRpY2tldFZpZXcgPSBuZXcgVnVlKHtcclxuICAgIGVsOiAnI3RpY2tldC12aWV3JyxcclxuICAgIFxyXG4gICAgZGF0YToge1xyXG4gICAgICBjbGFzc2VzOiB7XHJcbiAgICAgICAgaGlkZTogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBtb2RlOiB7XHJcbiAgICAgICAgbmV3Q29tbWVudDogZmFsc2UsXHJcbiAgICAgICAgZWRpdDogZmFsc2UsXHJcbiAgICAgIH0sXHJcbiAgICAgIG5ld19jb21tZW50OiAnJyxcclxuICAgICAgY29tbWVudHM6IFtdLFxyXG4gICAgICB0aWNrZXQ6IGVtcHR5VGlja2V0XHJcbiAgICB9LFxyXG4gICAgY3JlYXRlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAkKCcjdGlja2V0LXZpZXcnKS5yZW1vdmVDbGFzcygnaW52aXNpYmxlJylcclxuICAgIH0sXHJcblxyXG4gICAgbWV0aG9kczoge1xyXG4gICAgICBnZXRUaWNrZXQ6IGZ1bmN0aW9uIChpZF9hdmVyaWEpIHtcclxuICAgICAgICB2YXIgZm9ybSA9ICdkYXRhPScgKyBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBpZF9hdmVyaWE6IGlkX2F2ZXJpYVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdmFyIHNlbmQgPSBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ2FwaS9hdmVyaWFzL2dldF9hdmVyaWEnLCBmb3JtKTtcclxuICAgICAgICBcclxuICAgICAgICBzZW5kLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgdmFyIGRhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgIHRpY2tldFZpZXcuY2xhc3Nlcy5oaWRlID0gZmFsc2U7XHJcbiAgICAgICAgICB0aWNrZXRMaXN0Vmlldy5oaWRlID0gdHJ1ZTtcclxuICAgICAgICAgIHRpY2tldFZpZXcudGlja2V0ID0gZGF0YS50aWNrZXQ7XHJcbiAgICAgICAgICB0aWNrZXRWaWV3LmNvbW1lbnRzID0gZGF0YS5jb21tZW50cztcclxuICAgICAgICB9KVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcXVpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudGlja2V0ID0gZW1wdHlUaWNrZXQ7XHJcbiAgICAgICAgdGhpcy5jb21tZW50cyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jbGFzc2VzLmhpZGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuY2xvc2VDb21tZW50TW9kZSgpO1xyXG4gICAgICAgIHRpY2tldExpc3RWaWV3LmhpZGUgPSBmYWxzZTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHByaW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcHJpbnQoKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHN0YXJ0Q29tbWVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubW9kZS5uZXdDb21tZW50ID0gdHJ1ZTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFkZENvbW1lbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZm9ybSA9IGdldEZvcm0oe2lkX2F2ZXJpYTogdGhpcy50aWNrZXQuaWRfYXZlcmlhLCBkZXNjcmlwY2lvbjogdGhpcy5uZXdfY29tbWVudH0pO1xyXG4gICAgICAgIHZhciBzZW5kID0gYXhpb3MucG9zdChCQVNFX1VSTCArICdhcGkvYXZlcmlhcy9hZGRfY29tbWVudCcsZm9ybSk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbmQudGhlbiggZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgc2VsZi5nZXRDb21tZW50cygpO1xyXG4gICAgICAgICAgc2VsZi5jbG9zZUNvbW1lbnRNb2RlKClcclxuICAgICAgICAgIGRpc3BsYXlNZXNzYWdlKHJlcy5kYXRhLm1lbnNhamUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgX2RlbGV0ZUNvbW1lbnQ6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdmFyIGNvbW1lbnRJdGVtID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlXHJcbiAgICAgICAgdmFyIGlkQ29tbWVudCA9IGUudGFyZ2V0LnBhcmVudE5vZGUuYXR0cmlidXRlc1snZGF0YS1pZCddLnZhbHVlXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbW1lbnRJdGVtLmNsYXNzTGlzdC5hZGQoJ3RvLWRlbGV0ZScpO1xyXG5cclxuICAgICAgICBzd2FsKHtcclxuICAgICAgICAgIHRpdGxlOiAnRXN0w6EgU2VndXJvPycsXHJcbiAgICAgICAgICB0ZXh0OiBcIlNlZ3VybyBkZSBxdWUgZWxpbWluYXIgZXN0ZSByZXBvcnRlP1wiLFxyXG4gICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxyXG4gICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcclxuICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnRWxpbWluYXInLFxyXG4gICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ0NhbmNlbGFyJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcclxuICAgICAgICAgIHNlbGYuZGVsZXRlQ29tbWVudChpZENvbW1lbnQpO1xyXG4gICAgICAgICAgY29tbWVudEl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgndG8tZGVsZXRlJylcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBjb21tZW50SXRlbS5jbGFzc0xpc3QucmVtb3ZlKCd0by1kZWxldGUnKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBkZWxldGVDb21tZW50OiBmdW5jdGlvbiAoaWRDb21tZW50KXtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGZvcm0gPSBnZXRGb3JtKHsgaWRfcmVwb3J0ZTogaWRDb21tZW50fSk7XHJcbiAgICAgICAgdmFyIHNlbmQgPSBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ2FwaS9hdmVyaWFzL2RlbGV0ZV9jb21tZW50Jyxmb3JtKTtcclxuXHJcbiAgICAgICAgc2VuZC50aGVuKCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICBzZWxmLmdldENvbW1lbnRzKCk7XHJcbiAgICAgICAgICBkaXNwbGF5TWVzc2FnZShyZXMuZGF0YS5tZW5zYWplKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGVkaXRDb21tZW50OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB9LFxyXG4gICAgICBcclxuICAgICAgY2xvc2VDb21tZW50TW9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubW9kZS5uZXdDb21tZW50ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5uZXdfY29tbWVudCA9ICcnO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0Q29tbWVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZm9ybSA9IGdldEZvcm0oe2lkX2F2ZXJpYTogdGhpcy50aWNrZXQuaWRfYXZlcmlhfSk7XHJcbiAgICAgICAgdmFyIHNlbmQgPSBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ2FwaS9hdmVyaWFzL2dldF9jb21tZW50cycsZm9ybSk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzXHJcbiAgICAgICAgc2VuZC50aGVuKCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICBzZWxmLmNvbW1lbnRzID0gcmVzLmRhdGEuY29tbWVudHM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB1cGRhdGVEZXNjcmlwdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudXBkYXRlVGlja2V0KFsnaWRfYXZlcmlhJywnZGVzY3JpcGNpb24nLCd0ZWNuaWNvJywnZXN0YWRvJywnZmVjaGFfcmVwYXJhY2lvbiddKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVwZGF0ZVN0YXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGlja2V0LmVzdGFkbyA9PSAncG9yIHJlcGFyYXInKSB7XHJcbiAgICAgICAgICB0aGlzLnRpY2tldC5mZWNoYV9yZXBhcmFjaW9uID0gJydcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy50aWNrZXQuZmVjaGFfcmVwYXJhY2lvbiA9IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVwZGF0ZVRpY2tldDogZnVuY3Rpb24gKGZpZWxkcykge1xyXG4gICAgICAgIHRoaXMuY2xvc2VFZGl0TW9kZSgpO1xyXG4gICAgICAgIHZhciBmb3JtID0gZ2V0Rm9ybSh0aGlzLmdldEZpZWxkcyhmaWVsZHMpKTtcclxuICAgICAgICB2YXIgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnYXBpL2F2ZXJpYXMvdXBkYXRlX2F2ZXJpYScsZm9ybSk7XHJcblxyXG4gICAgICAgIHNlbmQudGhlbiggZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgdGlja2V0TGlzdFZpZXcuc2VhcmNoKCk7XHJcbiAgICAgICAgICBkaXNwbGF5TWVzc2FnZShyZXMuZGF0YS5tZW5zYWplKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBkZWxldGVUaWNrZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ2RlbGV0ZWQnKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGNsb3NlRWRpdE1vZGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm1vZGUuZWRpdCA9IGZhbHNlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZW50ZXJFZGl0TW9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubW9kZS5lZGl0ID0gdHJ1ZTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGdldEZpZWxkczogZnVuY3Rpb24gKGZpZWxkcykge1xyXG4gICAgICAgIHZhciBzZWxlY3RlZEZpZWxkcyA9IHt9O1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmaWVsZHMuZm9yRWFjaChmdW5jdGlvbihmaWVsZCkge1xyXG4gICAgICAgICAgc2VsZWN0ZWRGaWVsZHNbZmllbGRdID0gc2VsZi50aWNrZXRbZmllbGRdXHJcbiAgICAgICAgfSwgdGhpcyk7XHJcblxyXG4gICAgICAgIHJldHVybiBzZWxlY3RlZEZpZWxkcztcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuICB9KVxyXG5cclxuICBmdW5jdGlvbiBnZXRGb3JtKG9iamVjdCl7XHJcbiAgICByZXR1cm4gXCJkYXRhPVwiICsgSlNPTi5zdHJpbmdpZnkob2JqZWN0KTtcclxuICB9XHJcbiIsInZhciBjbG9zZVJlcG9ydCA9IG5ldyBWdWUoe1xyXG4gIGVsOiAnI2NpZXJyZXMnLFxyXG4gIGRhdGE6IHtcclxuICAgdGFibGU6ICcnLFxyXG4gICB0YWJsZUhUTUw6ICcnLFxyXG4gICBoYXNUb3RhbHM6IGZhbHNlLFxyXG4gICB0b3RhbHM6IGZhbHNlLFxyXG4gICBiZXR3ZWVuOiB7XHJcbiAgICAgZmlyc3RfZGF0ZTogJycsXHJcbiAgICAgc2Vjb25kX2RhdGU6ICcnLFxyXG4gICAgIHRleHQ6ICcnXHJcbiAgIH1cclxuICB9LFxyXG5cclxuICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoY3VycmVudFBhZ2UgPT0gJ2luZm9ybWVzJykge1xyXG4gICAgICB0aGlzLmdldFJlcG9ydCgpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGZpbHRlcnM6IHtcclxuICAgIGN1cnJlbmN5Rm9ybWF0OiBmdW5jdGlvbihudW1iZXIpe1xyXG4gICAgICByZXR1cm4gXCJSRCQgXCIrIEN1cnJlbmN5Rm9ybWF0KG51bWJlcik7XHJcbiAgICB9LFxyXG4gIH0sXHJcblxyXG4gIG1ldGhvZHM6IHtcclxuICAgIGdldFJlcG9ydDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHZhciBmb3JtID0gJ2RhdGE9JyArIEpTT04uc3RyaW5naWZ5KHRoaXMuYmV0d2VlbilcclxuICAgICAgYXhpb3MucG9zdChCQVNFX1VSTCArICdjYWphL2dldF9jaWVycmVzL3RydWUnLCBmb3JtKVxyXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgc2VsZi5maWxsVGFibGUocmVzLmRhdGEuY29udGVudCk7XHJcbiAgICAgICAgc2VsZi5oYXNUb3RhbHMgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYudG90YWxzICAgID0gcmVzLmRhdGEuYWN1bTtcclxuICAgICAgfSlcclxuICAgIH0sXHJcblxyXG4gICAgZmlsbFRhYmxlOiBmdW5jdGlvbihjb250ZW50KSB7XHJcbiAgICAgIGZpbGxCU1RhYmxlKCcjY2llcnJlcy10YWJsZScsIGNvbnRlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxufSkiLCJ2YXIgZXhwZW5zZXNSZXBvcnQgPSBuZXcgVnVlKHtcclxuICBlbDogJyNnYXN0b3MnLFxyXG4gIGRhdGE6IHtcclxuICAgdGFibGU6ICcnLFxyXG4gICB0YWJsZUhUTUw6ICcnLFxyXG4gICB0b3RhbDogJycsXHJcbiAgIGJldHdlZW46IHtcclxuICAgICBmaXJzdF9kYXRlOiAnJyxcclxuICAgICBzZWNvbmRfZGF0ZTogJycsXHJcbiAgICAgdGV4dDogJydcclxuICAgfVxyXG4gIH0sXHJcblxyXG4gIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmIChjdXJyZW50UGFnZSA9PSAnaW5mb3JtZXMnKSB7XHJcbiAgICAgIHRoaXMuZ2V0UmVwb3J0KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZmlsdGVyczoge1xyXG4gICAgY3VycmVuY3lGb3JtYXQ6IGZ1bmN0aW9uKG51bWJlcil7XHJcbiAgICAgIHJldHVybiBcIlJEJCBcIisgQ3VycmVuY3lGb3JtYXQobnVtYmVyKTtcclxuICAgIH0sXHJcbiAgfSxcclxuXHJcbiAgbWV0aG9kczoge1xyXG4gICAgZ2V0UmVwb3J0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgdmFyIGZvcm0gPSAnZGF0YT0nICsgSlNPTi5zdHJpbmdpZnkodGhpcy5iZXR3ZWVuKVxyXG4gICAgICBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ2NhamEvZ2V0X2dhc3Rvcy90cnVlJywgZm9ybSlcclxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIHNlbGYuZmlsbFRhYmxlKHJlcy5kYXRhLmNvbnRlbnQpXHJcbiAgICAgICAgc2VsZi50b3RhbCA9IHJlcy5kYXRhLmFjdW07XHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIGZpbGxUYWJsZTogZnVuY3Rpb24oY29udGVudCkge1xyXG4gICAgICBmaWxsQlNUYWJsZSgnI2dhc3Rvcy10YWJsZScsIGNvbnRlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxufSkiLCJ2YXIgZXh0cmFTZWN0aW9uID0gbmV3IFZ1ZSh7XHJcbiAgZWw6ICcjZXh0cmEtc2VjdGlvbicsXHJcbiAgZGF0YToge1xyXG4gICAgY29udGVudDogJycsXHJcbiAgICBzZWFyY2g6IHtcclxuICAgICAgdGV4dDogJycsXHJcbiAgICAgIHN0YXRlOiAnYWN0aXZvJ1xyXG4gICAgfSxcclxuICAgIHRvdGFsZXM6IHtcclxuICAgICAgcGFnYWRvOiAwLFxyXG4gICAgICBwZW5kaWVudGU6IDAsXHJcbiAgICAgIHRvdGFsX3ZlbmRpZG86IDBcclxuICAgIH0sXHJcbiAgICB0YWJsZUlkOiAnI2V4dHJhLXRhYmxlLWZ1bGwnXHJcbiAgfSxcclxuICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoY3VycmVudFBhZ2UgPT0gJ2V4dHJhcycpIHtcclxuICAgICAgdGhpcy5nZXREYXRhKCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZmlsdGVyczoge1xyXG4gICAgY3VycmVuY3lGb3JtYXQ6IGZ1bmN0aW9uKG51bWJlcil7XHJcbiAgICAgIHJldHVybiBcIlJEJCBcIisgQ3VycmVuY3lGb3JtYXQobnVtYmVyKTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBcclxuICBtZXRob2RzOiB7XHJcbiAgICBmaWx0ZXI6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZmlsdGVyQlNUYWJsZSh0aGlzLnRhYmxlSWQsdGhpcy5maWx0ZXJWYWx1ZSk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBnZXREYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgdmFyIGZvcm0gPSAnZGF0YT0nICsgSlNPTi5zdHJpbmdpZnkodGhpcy5zZWFyY2gpXHJcbiAgICAgIGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnZXh0cmEvZ2V0X2FsbCcsZm9ybSlcclxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIHNlbGYuZmlsbFRhYmxlKHJlcy5kYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgIHNlbGYudG90YWxlcyA9IHJlcy5kYXRhLnRvdGFsZXM7XHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIGZpbGxUYWJsZTogZnVuY3Rpb24gKGNvbnRlbnQpIHtcclxuICAgICAgZmlsbEJTVGFibGUoJyNleHRyYS10YWJsZS1mdWxsJywgY29udGVudClcclxuICAgIH1cclxuICB9XHJcbn0pO1xyXG4iLCJcclxudmFyIGNvbmZpZ01lc3NhZ2UgPSB7XHJcbiAgZW1haWw6ICcnLFxyXG4gIHBhc3N3b3JkOiAnJyxcclxuICBkZXZpY2VfaWQ6ICcnLFxyXG4gIGNvdW50cnlfY29kZTogJycsXHJcbiAgc2VuZF9hdDogJzEgc2Vjb25kJyxcclxuICBleHBpcmVzX2F0OiAnMSBob3VyJ1xyXG59XHJcblxyXG52YXIgY29uZmlnTWVzc2FnZXNGb3JtID0gbmV3IFZ1ZSh7XHJcbiAgZWw6ICcjbWVzc2FnZS1zZXR0aW5ncy1zZWN0aW9uJyxcclxuICBkYXRhOiB7XHJcbiAgICBjb25maWc6IGNvbmZpZ01lc3NhZ2VcclxuICB9LFxyXG4gIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2V0Q29uZmlnKClcclxuICB9LFxyXG5cclxuICBtZXRob2RzOiB7XHJcbiAgICBjb25maXJtUGhvbmU6IGZ1bmN0aW9uICgpIHt9LFxyXG5cclxuICAgIGdldENvbmZpZzogZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgc2VuZFxyXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHNlbmQgPSBheGlvcy5nZXQoQkFTRV9VUkwgKyAnbWVzc2FnZXMvZ2V0X2NvbmZpZycpXHJcbiAgICAgIHNlbmQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgaWYocmVzLmRhdGEuY29uZmlnKXtcclxuICAgICAgICAgIHNlbGYuY29uZmlnID0gcmVzLmRhdGEuY29uZmlnXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICBzZW5kLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuXHJcbiAgICBzYXZlU2V0dGluZ3M6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIHZhciBjb25maWcsIGZvcm0sIHNlbmRcclxuICAgICAgY29uZmlnID0gdGhpcy5jb25maWdcclxuXHJcbiAgICAgIGZvcm0gPSAnZGF0YT0nICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKVxyXG4gICAgICBzZW5kID0gYXhpb3MucG9zdChCQVNFX1VSTCArICdtZXNzYWdlcy9zYXZlX2NvbmZpZycsIGZvcm0pXHJcbiAgICAgIHNlbmQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgZGlzcGxheU1lc3NhZ2UocmVzLmRhdGEubWVuc2FqZSlcclxuICAgICAgfSlcclxuICAgICAgc2VuZC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufSlcclxuXHJcbnZhciBzZW5kTWVzc2FnZUFwcCA9IG5ldyBWdWUoe1xyXG4gIGVsOiAnI3NlbmQtbWVzc2FnZS1tb2RhbCcsXHJcblxyXG4gIGRhdGE6IHtcclxuICAgIGhpZGVfY2xpZW50czogdHJ1ZSxcclxuICAgIGhpZGVfbnVtYmVyczogdHJ1ZSxcclxuXHJcbiAgICBtZXNzYWdlX2RhdGE6IHtcclxuICAgICAgdGlwbzogJycsXHJcbiAgICAgIGNsaWVudGVzOiAnJyxcclxuICAgICAgbnVtZXJvczogJycsXHJcbiAgICAgIG1lbnNhamU6ICcnXHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgbW91bnRlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5pbml0U2VsZWN0MigpXHJcbiAgfSxcclxuXHJcbiAgY29tcHV0ZWQ6IHtcclxuICAgIGxldHRlcnNfY291bnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZV9kYXRhLm1lbnNhamUubGVuZ3RoXHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgbWV0aG9kczoge1xyXG4gICAgc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGZvcm0sIHNlbmRcclxuXHJcbiAgICAgIGlmICghaXNFbXB0eShbdGhpcy5tZXNzYWdlX2RhdGEudGlwbywgdGhpcy5tZXNzYWdlX2RhdGEubWVuc2FqZV0pKSB7XHJcbiAgICAgICAgZm9ybSA9ICdkYXRhPScgKyBKU09OLnN0cmluZ2lmeSh0aGlzLm1lc3NhZ2VfZGF0YSlcclxuICAgICAgICBzZW5kID0gYXhpb3MucG9zdChCQVNFX1VSTCArICdtZXNzYWdlcy9zZW5kX21lc3NhZ2UnLCBmb3JtKVxyXG4gICAgICAgIHNlbmQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICBkaXNwbGF5TWVzc2FnZShyZXMuZGF0YS5tZW5zYWplKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgc2VuZC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3dhbCgnQ2FtcG9zIFJlcXVlcmlkb3MnLCAnUG9yIGZhdm9yIHNlbGVjY2lvbmVzIGVsIHRpcG8gZGUgbWVuc2FqZSB5IGVzY3JpYmEgc3UgbWVuc2FqZScpXHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW5pdFNlbGVjdDI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHNlbGYgPSB0aGlzXHJcbiAgICAgIHZhciBvcHRpb25zID0ge1xyXG4gICAgICAgIGRyb3Bkb3duUGFyZW50OiAkKCcjc2VuZC1tZXNzYWdlLW1vZGFsJylcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHNlbGVjdE1lc3NhZ2VUeXBlID0gJCgnI21lc3NhZ2UtdHlwZScpXHJcbiAgICAgIHNlbGVjdE1lc3NhZ2VUeXBlLnNlbGVjdDIob3B0aW9ucylcclxuICAgICAgdmFyIHNlbGVjdENsaWVudHNGb3JNZXNzYWdlID0gJCgnI2NsaWVudHMtZm9yLW1lc3NhZ2UnKS5zZWxlY3QyKHtcclxuICAgICAgICBkcm9wZG93blBhcmVudDogJCgnI3NlbmQtbWVzc2FnZS1tb2RhbCcpLFxyXG4gICAgICAgIGFqYXg6IHtcclxuICAgICAgICAgIHVybDogQkFTRV9VUkwgKyAnbWVzc2FnZXMvc2VhcmNoX2NsaWVudHMnLFxyXG4gICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgIGRlbGF5OiAyNTAsXHJcbiAgICAgICAgICBkYXRhOiBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgcTogcGFyYW1zLnRlcm0sXHJcbiAgICAgICAgICAgICAgcGFnZTogcGFyYW1zLnBhZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBwcm9jZXNzUmVzdWx0czogZnVuY3Rpb24gKGRhdGEsIHBhcmFtcykge1xyXG4gICAgICAgICAgICBwYXJhbXMucGFnZSA9IHBhcmFtcy5wYWdlIHx8IDFcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICByZXN1bHRzOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICAgICAgICAgIG1vcmU6IChwYXJhbXMucGFnZSAqIDMwKSA8IGRhdGEudG90YWxfY291bnRcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjYWNoZTogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIHZhciBzZWxlY3RzID0ge1xyXG4gICAgICAgIGNsaWVudHM6IHNlbGVjdENsaWVudHNGb3JNZXNzYWdlLFxyXG4gICAgICAgIG1lc3NhZ2VUeXBlOiBzZWxlY3RNZXNzYWdlVHlwZVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc2VsZWMyTGl0ZW5lcnMoc2VsZWN0cylcclxuICAgIH0sXHJcblxyXG4gICAgc2VsZWMyTGl0ZW5lcnM6IGZ1bmN0aW9uIChzZWxlY3RzKSB7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgICBzZWxlY3RzLm1lc3NhZ2VUeXBlLm9uKCdzZWxlY3QyOnNlbGVjdCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdmFyIHNlbGVjdCA9IGUucGFyYW1zLmRhdGEuZWxlbWVudFxyXG4gICAgICAgIHZhciBhdHRyaWJ1dGVzID0gc2VsZWN0LmF0dHJpYnV0ZXNcclxuICAgICAgICB2YXIgdGlwbyA9IGUucGFyYW1zLmRhdGEuaWRcclxuICAgICAgICBzZWxmLm1lc3NhZ2VfZGF0YS50aXBvID0gdGlwb1xyXG5cclxuICAgICAgICBpZiAodGlwbyA9PSAnb3Ryb3MnKSB7XHJcbiAgICAgICAgICBzZWxmLmhpZGVfY2xpZW50cyA9IHRydWVcclxuICAgICAgICAgIHNlbGYuaGlkZV9udW1iZXJzID0gZmFsc2VcclxuICAgICAgICB9IGVsc2UgaWYgKHRpcG8gPT0gJ3BlcnNvbmFsaXphZG8nKSB7XHJcbiAgICAgICAgICBzZWxmLmhpZGVfbnVtYmVycyA9IHRydWVcclxuICAgICAgICAgIHNlbGYuaGlkZV9jbGllbnRzID0gZmFsc2VcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc2VsZi5oaWRlX2NsaWVudHMgPSB0cnVlXHJcbiAgICAgICAgICBzZWxmLmhpZGVfbnVtYmVycyA9IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBzZWxlY3RzLm1lc3NhZ2VUeXBlLnNlbGVjdDIoJ3ZhbCcsJ21vcmEnKTtcclxuXHJcbiAgICAgIHNlbGVjdHMuY2xpZW50cy5vbignc2VsZWN0MjpzZWxlY3QnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHZhciBjbGllbnRlcyA9IHNlbGVjdHMuY2xpZW50cy5zZWxlY3QyKCdkYXRhJylcclxuICAgICAgICB2YXIgaXRlbXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsaWVudGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBpdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgJ25vbWJyZV9jb21wbGV0byc6IGNsaWVudGVzW2ldLnRleHQsXHJcbiAgICAgICAgICAgICdjZWx1bGFyJzogY2xpZW50ZXNbaV0uaWRcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYubWVzc2FnZV9kYXRhLmNsaWVudGVzID0gaXRlbXNcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcbn0pIiwidmFyIHBheW1lbnRzUmVwb3J0ID0gbmV3IFZ1ZSh7XHJcbiAgZWw6ICcjcmVjaWJvcycsXHJcbiAgZGF0YToge1xyXG4gICB0YWJsZTogJycsXHJcbiAgIHRhYmxlSFRNTDogJycsXHJcbiAgIHRvdGFsOiAnJyxcclxuICAgYmV0d2Vlbjoge1xyXG4gICAgIGZpcnN0X2RhdGU6ICcnLFxyXG4gICAgIHNlY29uZF9kYXRlOiAnJyxcclxuICAgICB0ZXh0OiAnJ1xyXG4gICB9XHJcbiAgfSxcclxuICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoY3VycmVudFBhZ2UgPT0gJ25vdGlmaWNhY2lvbmVzJykge1xyXG4gICAgICB0aGlzLmdldFJlcG9ydCgpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgZmlsdGVyczoge1xyXG4gICAgY3VycmVuY3lGb3JtYXQ6IGZ1bmN0aW9uKG51bWJlcil7XHJcbiAgICAgIHJldHVybiBcIlJEJCBcIisgQ3VycmVuY3lGb3JtYXQobnVtYmVyKTtcclxuICAgIH0sXHJcbiAgfSxcclxuXHJcbiAgbWV0aG9kczoge1xyXG4gICAgZ2V0UmVwb3J0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgdmFyIGZvcm0gPSAnZGF0YT0nICsgSlNPTi5zdHJpbmdpZnkodGhpcy5iZXR3ZWVuKVxyXG4gICAgICBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ3BheW1lbnQvZ2V0X3JlY2VpcHRzLycsIGZvcm0pXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICBzZWxmLmZpbGxUYWJsZShyZXMuZGF0YS5jb250ZW50KVxyXG4gICAgICAgIHNlbGYudG90YWwgPSByZXMuZGF0YS5hY3VtO1xyXG4gICAgICB9KVxyXG4gICAgfSxcclxuXHJcbiAgICBmaWxsVGFibGU6IGZ1bmN0aW9uKGNvbnRlbnQpIHtcclxuICAgICAgdmFyICR0YWJsZSA9ICQoJyNyZWNlaXB0cy10YWJsZScpXHJcbiAgICAgICR0YWJsZS5ib290c3RyYXBUYWJsZSgnZGVzdHJveScpO1xyXG4gICAgICAkdGFibGUuZmluZCgndGJvZHknKS5odG1sKGNvbnRlbnQpO1xyXG4gICAgICAkdGFibGUuYm9vdHN0cmFwVGFibGUoKTtcclxuICAgICAgJHRhYmxlLmZpbmQoJ3Rib2R5JykuY3NzKHtkaXNwbGF5OlwidGFibGUtcm93LWdyb3VwXCJ9KTtcclxuICAgIH1cclxuICB9XHJcbn0pIiwidmFyIFJldGlyZW1lbnRSZXBvcnQgPSBuZXcgVnVlKHtcclxuICBlbDogJyNyZXRpcm9zJyxcclxuICBkYXRhOiB7XHJcbiAgIHRhYmxlOiAnJyxcclxuICAgdGFibGVIVE1MOiAnJyxcclxuICAgYmV0d2Vlbjoge1xyXG4gICAgIGZpcnN0X2RhdGU6ICcnLFxyXG4gICAgIHNlY29uZF9kYXRlOiAnJ1xyXG4gICB9XHJcbiAgfSxcclxuICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoY3VycmVudFBhZ2UgPT0gJ25vdGlmaWNhY2lvbmVzJykge1xyXG4gICAgICB0aGlzLmdldFJlcG9ydCgpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG1ldGhvZHM6IHtcclxuICAgIGdldFJlcG9ydDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHZhciBmb3JtID0gJ2RhdGE9JyArIEpTT04uc3RyaW5naWZ5KHRoaXMuYmV0d2VlbilcclxuICAgICAgYXhpb3MucG9zdChCQVNFX1VSTCArICdjb250cmFjdC9nZXRDYW5jZWxhdGlvbnMvJywgZm9ybSlcclxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIHNlbGYuZmlsbFRhYmxlKHJlcy5kYXRhLmNvbnRlbnQpXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIGZpbGxUYWJsZTogZnVuY3Rpb24oY29udGVudCkge1xyXG4gICAgICB2YXIgJHRhYmxlID0gJCgnI2NhbmNlbGF0aW9uLXRhYmxlJylcclxuICAgICAgJHRhYmxlLmJvb3RzdHJhcFRhYmxlKCdkZXN0cm95Jyk7XHJcbiAgICAgICR0YWJsZS5maW5kKCd0Ym9keScpLmh0bWwoY29udGVudCk7XHJcbiAgICAgICR0YWJsZS5ib290c3RyYXBUYWJsZSgpO1xyXG4gICAgICAkdGFibGUuZmluZCgndGJvZHknKS5jc3Moe2Rpc3BsYXk6XCJ0YWJsZS1yb3ctZ3JvdXBcIn0pO1xyXG4gICAgfVxyXG4gIH1cclxufSkiXX0=
