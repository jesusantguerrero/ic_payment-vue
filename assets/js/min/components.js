"use strict";function isCurrentPage(t){return getCurrentPage()==t}function getCurrentPage(){var t=$("title").text().split(" ");return t=t[4].toLowerCase().trim()}function fillBSTable(t,e){var a=$(t);a.bootstrapTable("destroy"),a.find("tbody").html(e),a.bootstrapTable(),$(".pull-right.search").addClass("hide"),a.find("tbody").css({display:"table-row-group"}),a.addClass("innertable")}function filterBSTable(t,e){$(t).bootstrapTable("filterBy",{estado:e})}isCurrentPage("cuenta")&&new Vue({el:"#acount-section",data:{user:{user_id:"",nickname:"",name:"",lastname:"",dni:"",type:"",email:""},isChangePassword:!1,currentPassword:"",newPassword:"",passwordConfirm:"",states:{"has-error":!1,"has-success":!1,button:!0}},mounted:function(){"cuenta"==currentPage&&this.getUser()},methods:{getUser:function(){var t=this,e=$("#acount-user-id").val(),a="data="+JSON.stringify({user_id:e});axios.post(BASE_URL+"user/get_user",a).then(function(e){var a=e.data.user;a.fullname=a.name+" "+a.lastname,t.user=a})},updateInfo:function(){this.isChangePassword?this.changePassword():this.changeEmail()},changePassword:function(){if(this.states["has-success"]){var t="data="+JSON.stringify({user_id:this.user.user_id,current_password:this.currentPassword,new_password:this.newPassword});axios.post(BASE_URL+"user/update_password",t).then(function(t){displayMessage(t.data.message),window.location=BASE_URL+"app/logut"})}else displayMessage("Las contraseñas no conciden")},changeEmail:function(){var t=this.user;swal({title:"Contraseña",input:"password"}).then(function(e){var a="data="+JSON.stringify({user_id:t.user_id,password:e,field:"email",value:t.email});axios.post(BASE_URL+"user/update_field",a).then(function(t){displayMessage(t.data.message)})})},confirmPasswordServer:function(t){var e="data="+JSON.stringify({user_id:this.user.user_id,current_password:t});return new Promise(function(t,a){axios.post(BASE_URL+"user/confirm_password",e).then(function(e){t(e.data.is_correct)})})},confirmPassword:function(){var t=this;this.confirmPasswordServer(this.currentPassword).then(function(e){t.isChangePassword=e})},checkPassword:function(){this.newPassword==this.passwordConfirm&&this.changePassword?(this.setStates(!0,!1),this.states.button=!0):this.changePassword?(this.setStates(!1,!0),this.states.button=!1):this.setStates(!1,!1)},setStates:function(t,e){this.states["has-success"]=t,this.states["has-error"]=e}}}),isCurrentPage("cierre")&&function(){function t(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a]);return e}function e(){return moment().format("YYYY-MM-DD")}var a={total1:0,total5:0,total10:0,total20:0,total25:0,total50:0,total100:0,total200:0,total500:0,total1000:0,total2000:0},o={fecha:"",descripcion:"",monto:""},i=[{fecha:e(),descripcion:"hola",monto:2e3,id_gasto:1}],s=$("#autor-cierre").text().trim(),n=new Vue({el:"#app-cierre",data:{isHide:!1,fecha:e(),data_cierre:{autor:s,pagos_facturas:0,pagos_extras:0,pagos_efectivo:0,pagos_banco:0,total_ingresos:0,efectivo_caja:0,total_descuadre:0,total_gastos:0,banco:0},conteo:a,suma:0,gasto:o,gastos:i},mounted:function(){this.getGastos(),this.setIngresos()},created:function(){$(".will-load").css({visibility:"visible"})},filters:{currencyFormat:function(t){return CurrencyFormat(t)}},methods:{changeTotal:function(t){var e=t.srcElement.attributes["data-unit"].value,o=t.srcElement.value;a["total"+e]=o*e*1},addGasto:function(t){var a=this.gasto;a.fecha=e();var o="data="+JSON.stringify(a),i=axios.post(BASE_URL+"caja/add_gasto",o);i.then(function(t){var e=t.data;displayMessage(e.mensaje),n.fillGastos(e.gastos,"normal"),n.setGastoTotal(e.total_gastos)}),i.catch(function(){console.log(error)})},fillGastos:function(t,e){"group"==e?null!=t||t.length>0?n.gastos=t:n.gastos=[]:n.gastos.push(JSON.parse(t)[0])},setGastoTotal:function(t){this.data_cierre.total_gastos=t},getGasto:function(t){var e=this.gasto,a="data="+JSON.stringify(e);connectAndSend("caja/get_gasto",!1,null,n.fillGastos,a,null,null)},deleteGasto:function(t){var a=t.target;"i"==a.localname&&(a=a.parentElement);var o=a.attributes["data-id"].value;swal({title:"Está Seguro?",text:"Seguro de que quiere eliminar este gasto?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",cancelButtonText:"Cancelar"}).then(function(){var t="data="+JSON.stringify({id:o,fecha:e()}),a=axios.post(BASE_URL+"caja/delete_gasto",t);a.then(function(t){var e=t.data;displayMessage(e.mensaje),n.fillGastos(e.gastos,"group"),n.setGastoTotal(e.total_gastos)}),a.catch(function(t){})})},getGastos:function(){var t={fecha:e()},a="data="+JSON.stringify(t),o=axios.post(BASE_URL+"caja/get_gastos",a);o.then(function(t){var e=t.data;displayMessage(e.mensaje),n.fillGastos(e.gastos,"group"),n.setGastoTotal(e.total_gastos)}),o.catch(function(){console.log(error)})},setIngresos:function(){var t="data="+JSON.stringify({fecha:e()}),a=this.data_cierre,o=axios.post(BASE_URL+"caja/get_ingresos",t);o.then(function(t){var e=t.data;a.pagos_facturas=e.pagos_facturas,a.pagos_extras=e.pagos_extras,a.pagos_efectivo=e.pagos_efectivo,a.pagos_banco=e.pagos_banco,a.total_ingresos=parseFloat(e.pagos_facturas)+parseFloat(a.pagos_extras),a.total_descuadre=-a.pagos_efectivo+a.efectivo_caja}),o.catch(function(){console.log(error)})},cerrarCaja:function(){var t=this,e=this.data_cierre;window.cierre=e,0!=e.total_descuadre?swal({title:"Está Seguro?",text:"Hay un descuadre en la caja, quiere hacer el cierre de todos modos?",type:"warning",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(function(){t.cerrar(e)}):t.cerrar(e)},cerrar:function(t){t.fecha=e();var a="data="+JSON.stringify(t),o=axios.post(BASE_URL+"caja/add_cierre",a);o.then(function(e){var a=e.data;displayMessage(a.mensaje),self.isHide=!0,r.isHide=!1,r.cierre=t,$("#app-cierre").addClass("hide"),$(".top-nav").addClass("hide"),$("#print-view").css({visibility:"visible"})}),o.catch(function(){console.log(error)})}},computed:{getTotal:function(e){var o=a,i=this.data_cierre,s=t([o.total1,o.total5,o.total10,o.total20,o.total25,o.total50,o.total100,o.total200,o.total500,o.total1000,o.total2000]);return this.suma=s,i.efectivo_caja=s.toFixed(2),i.total_descuadre=parseFloat(-i.pagos_efectivo)+parseFloat(i.efectivo_caja),i.banco=parseFloat(i.pagos_banco)+parseFloat(i.pagos_efectivo)-parseFloat(i.total_gastos)+parseFloat(i.total_descuadre),this.suma},decimals:function(){["pagos_facturas","pagos_extra","pagos_efectivo","pagos_banco","total_ingresos","efectivo_caja","total_descuadre","total_gasto","banco"].forEach(function(t){this.data_cierre[t]=this.data_cierre[t].toFixed(2)},this)}}}),r=new Vue({el:"#print-view",data:{isHide:!0,back:{link:"somelink",text:"volver a cierre"},foward:{link:BASE_URL+"app/logout",text:"cerrar session"},cierre:{autor:"",pagos_facturas:0,pagos_extras:0,pagos_efectivo:0,pagos_banco:0,total_ingresos:0,efectivo_caja:0,total_descuadre:0,total_gastos:0,banco:0}},filters:{currencyFormat:function(t){return"RD$ "+CurrencyFormat(t)},spanishDateFormat:function(t){return moment.locale("es-DO"),moment(t).format("dddd DD [de] MMMM [del] YYYY")}},methods:{goBack:function(){r.isHide=!0,n.isHide=!1,self.isHide=!0,$(".top-nav").removeClass("hide"),$("#app-cierre").removeClass("hide")},print:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){print()})}})}(),isCurrentPage("informes")&&new Vue({el:"#cierres",data:{table:"",tableHTML:"",hasTotals:!1,totals:!1,between:{first_date:"",second_date:"",text:""}},mounted:function(){"informes"==currentPage&&this.getReport()},filters:{currencyFormat:function(t){return"RD$ "+CurrencyFormat(t)}},methods:{getReport:function(){var t=this,e="data="+JSON.stringify(this.between);axios.post(BASE_URL+"caja/get_cierres/true",e).then(function(e){t.fillTable(e.data.content),t.hasTotals=!0,t.totals=e.data.acum})},fillTable:function(t){fillBSTable("#cierres-table",t)}}}),isCurrentPage("informes")&&new Vue({el:"#gastos",data:{table:"",tableHTML:"",total:"",between:{first_date:"",second_date:"",text:""}},mounted:function(){"informes"==currentPage&&this.getReport()},filters:{currencyFormat:function(t){return"RD$ "+CurrencyFormat(t)}},methods:{getReport:function(){var t=this,e="data="+JSON.stringify(this.between);axios.post(BASE_URL+"caja/get_gastos/true",e).then(function(e){t.fillTable(e.data.content),t.total=e.data.acum})},fillTable:function(t){fillBSTable("#gastos-table",t)}}}),isCurrentPage("detalles")&&function(){var t="",e={id_pago:0,id_contrato:0,id_servicio:0,id_empleado:0,fecha_pago:"",concepto:"extra",detalles_extra:"",cuota:"",mora:"",monto_extra:"",total:"",estado:"",fecha_limite:"",complete_date:"",descuento:"",razon_descuento:"",deuda:"",abono_a:"",tipo:"",generado:""},a=new Vue({el:"#app-pago-extra",data:{recibo:{id_pago:0,id_contrato:0,id_servicio:0,id_empleado:0,fecha_pago:"dd/mm/yyyy",concepto:"extra",detalles_extra:"",cuota:"",mora:"",monto_extra:"",total:"",estado:"",fecha_limite:"",complete_date:"",descuento:"",razon_descuento:"",deuda:"",abono_a:"",tipo:"",generado:""},visible:!1,pagado:!1,extra:{controls:"",id_extra:"",id_servicio:"",checkbox:"",fecha:"",concepto:"",ultimo_pago:"",monto_pagado:"",monto_total:"",estado:""},firstControls:{hide:!1}},filters:{},computed:{url_recibo:function(){return BASE_URL+"process/getrecibo/"+this.recibo.id_pago},hide_recibo:function(){return"pagado"!=this.recibo.estado&&(this.hide_recibo=!0)},isPagado:function(){return this.pagado="pagado"==this.recibo.estado,this.pagado}},methods:{goBack:function(){extraTable.el.parents(".bootstrap-table").removeClass("hide"),this.visible=!1,this.extra={concepto:""},extraTable.refresh(t)},generatePayment:function(){if(this.pagado||0==this.recibo.id_pago){var t="data="+JSON.stringify(this.extra),e=axios.post(BASE_URL+"extra/generate_extra_payment",t);e.then(function(t){var e=t.data;displayMessage(e.mensaje),o.html(e.pagos).change()}),e.catch(function(){})}else displayMessage(MESSAGE_INFO+" Debe realizar este pago antes de crear uno nuevo")},getPayment:function(t){var e="data="+JSON.stringify({id_pago:t}),a=this;axios.post(BASE_URL+"extra/get_payment",e).then(function(t){var e=t.data;e.recibo&&(a.recibo=e.recibo)})},applyPayment:function(){0!=this.recibo.id_pago?this.sender("extra/apply_payment"):displayMessage(MESSAGE_INFO+" Debe generar un pago primero")},editPayment:function(){this.sender("extra/edit_payment")},sender:function(e){var a=this,o=this.prepareData(),i=o.info,s=o.data,n="data="+JSON.stringify(s)+"&info="+JSON.stringify(i),r=axios.post(BASE_URL+e,n);r.then(function(e){var o=e.data;o.extras&&(t=o.extras),o.mensaje&&displayMessage(o.mensaje),a.getPayments(a.extra.id_extra)}),r.catch(function(t){console.log(t)})},prepareData:function(t){return{data:{concepto:"extra -",detalles_extra:(t=this.recibo).detalles_extra,fecha_pago:t.fecha_pago,cuota:t.cuota,total:t.cuota,estado:"pagado",tipo:t.tipo,generado:!0},info:{id_extra:t.id_extra,id_pago:t.id_pago}}},getPayments:function(t){var a=this,i="data="+JSON.stringify({id_extra:t});axios.post(BASE_URL+"extra/get_extra_payment_of",i).then(function(t){var i=t.data;i.pagos||(a.recibo=e),o.html(i.pagos).change()})},deletePayment:function(){var t=this,e=this.recibo,a={id_extra:e.id_extra,id_pago:e.id_pago},o="data="+JSON.stringify(a),i=axios.post(BASE_URL+"extra/delete_payment",o);i.then(function(e){var a=e.data;displayMessage(a.mensaje),t.getPayments(t.extra.id_extra)}),i.catch(function(t){console.log(t)})}}});bus.$on("row-selected",function(e){extraTable.el.parents(".bootstrap-table").addClass("hide"),a.visible=!0,a.extra=e,t=extraTable.el.find("tbody").html(),a.getPayments(e.id_extra)});var o=$("#select-extra-payment");o.on("change",function(){var t=o.val();a.getPayment(t)})}(),isCurrentPage("extras")&&new Vue({el:"#extra-section",data:{content:"",search:{text:"",state:"activo"},totales:{pagado:0,pendiente:0,total_vendido:0},tableId:"#extra-table-full"},mounted:function(){"extras"==currentPage&&this.getData()},filters:{currencyFormat:function(t){return"RD$ "+CurrencyFormat(t)}},methods:{filter:function(t){filterBSTable(this.tableId,this.filterValue)},getData:function(){var t=this,e="data="+JSON.stringify(this.search);axios.post(BASE_URL+"extra/get_all",e).then(function(e){t.fillTable(e.data.content),t.totales=e.data.totales})},fillTable:function(t){fillBSTable("#extra-table-full",t)}}}),isCurrentPage("notificaciones")&&new Vue({el:"#recibos",data:{table:"",tableHTML:"",total:"",between:{first_date:"",second_date:"",text:""}},mounted:function(){"notificaciones"==currentPage&&this.getReport()},filters:{currencyFormat:function(t){return"RD$ "+CurrencyFormat(t)}},methods:{getReport:function(){var t=this,e="data="+JSON.stringify(this.between);axios.post(BASE_URL+"payment/get_receipts/",e).then(function(e){t.fillTable(e.data.content),t.total=e.data.acum})},fillTable:function(t){var e=$("#receipts-table");e.bootstrapTable("destroy"),e.find("tbody").html(t),e.bootstrapTable(),e.find("tbody").css({display:"table-row-group"})}}}),isCurrentPage("reportes")&&function(){function t(t){var e=$("#ganancias-chart"),a={type:"bar",data:{labels:t.labels,datasets:[{label:"Valores",data:t.values,backgroundColor:[o.lightBlue6,o.lightBlue6,o.blue7,window.chartColors.blue,window.chartColors.green,o.blueGreen,window.chartColors.red,window.chartColors.red,window.chartColors.blue]}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{callback:function(t,e,a){return""!=t&&null!=t||(t=0),"RD$ "+CurrencyFormat(t)}}}],xAxes:[{ticks:{callback:function(t,e,a){return t.replace(/_/g," ")}}}]},tooltips:{callbacks:{label:function(t,e){return"RD$ "+CurrencyFormat(t.yLabel)}}},title:{display:!0,text:"Datos del ultimo cierre. hecho por "+t.autor+" el dia "+t.fecha}}};new Chart(e,a)}function e(t,e){var o=$("#ganancias-mes-chart"),i={labels:a,datasets:[{label:"Gastos",backgroundColor:window.chartColors.red,borderColor:window.chartColors.red,data:t,fill:!1},{label:"Banco(Ganancias)",fill:!1,backgroundColor:window.chartColors.blue,borderColor:window.chartColors.blue,data:e}]},s={responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{callback:function(t,e,a){return"RD$ "+CurrencyFormat(t)}}}]},tooltips:{callbacks:{label:function(t,e){return"RD$ "+CurrencyFormat(t.yLabel)}}},title:{display:!0,text:"Registros de cierre Este ultimo año"}};new Chart(o,{type:"line",data:i,options:s})}"reportes"==currentPage&&function(){var a=axios.get(BASE_URL+"caja/get_last_cierre");a.then(function(e){t(e.data),s.cierre=e.data.cierre}),a.catch(function(t){});var o="data="+JSON.stringify({year:moment().format("YYYY")});axios.post(BASE_URL+"caja/get_year_info",o).then(function(t){e(t.data.gastos,t.data.ganancias)})}(),window.chartColors={red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"};var a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],o={green:"rgba(0,230,118 ,1)",blueGreen:"rgba(29,233,182 ,1)",blue7:"rgba(25,118,210 ,1)",lightBlue6:"rgba(3,155,229 ,1)",red3:"rgba(229,115,115 ,1)",deepOrange4:"rgba(255,112,67 ,1)"},i={autor:"",banco:0,dinero_real_en_caja:0,fecha:"",pago_de_facturas:0,pagos_de_extras:0,pagos_en_efectivo:0,pagos_via_banco:0,total_de_ingresos:0,total_descuadre:0},s=new Vue({el:"#app-vista-detalle",data:{cierre:i},filters:{currencyFormat:function(t){return"RD$ "+CurrencyFormat(t)}},methods:{print:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){print()})}})}(),isCurrentPage("notificaciones")&&new Vue({el:"#retiros",data:{table:"",tableHTML:"",between:{first_date:"",second_date:""}},mounted:function(){"notificaciones"==currentPage&&this.getReport()},methods:{getReport:function(){var t=this,e="data="+JSON.stringify(this.between);axios.post(BASE_URL+"contract/getCancelations/",e).then(function(e){t.fillTable(e.data.content)})},fillTable:function(t){var e=$("#cancelation-table");e.bootstrapTable("destroy"),e.find("tbody").html(t),e.bootstrapTable(),e.find("tbody").css({display:"table-row-group"})}}}),isCurrentPage("notificaciones")&&function(){function t(t){return"data="+JSON.stringify(t)}var e=new Vue({el:"#averias-list-view",data:{dataSearch:{text:"",state:"por reparar"},tickets:[],hide:!1},mounted:function(){this.itemClickListener();var t=this;busAveria.$on("tickets-listed",function(){t.itemClickListener()})},methods:{search:function(){var t=this,e="data="+JSON.stringify(this.dataSearch),a=axios.post(BASE_URL+"api/averias/search",e);a.then(function(e){t.fillAveriasList(e.data)}),a.catch(function(){console.error(res.data.mensaje)})},fillAveriasList:function(t){$("#averias-list").html(t),e.itemClickListener()},itemClickListener:function(){$("#averias-list-view .averia-item").on("click",function(){var t=$(this).find(".code").text().trim();o.getTicket(t)})}}}),a={id_averia:"",id_cliente:"",cliente:"",direccion:"",descripcion:"",celular:"",fecha:"",estado:"",fecha_reparacion:"",tecnico:"",codigo:""},o=new Vue({el:"#ticket-view",data:{classes:{hide:!0},mode:{newComment:!1,edit:!1},new_comment:"",comments:[],ticket:a},created:function(){$("#ticket-view").removeClass("invisible")},methods:{getTicket:function(t){var a="data="+JSON.stringify({id_averia:t});axios.post(BASE_URL+"api/averias/get_averia",a).then(function(t){var a=t.data;o.classes.hide=!1,e.hide=!0,o.ticket=a.ticket,o.comments=a.comments})},quit:function(){this.ticket=a,this.comments=null,this.classes.hide=!0,this.closeCommentMode(),e.hide=!1},print:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){print()}),startComment:function(){this.mode.newComment=!0},addComment:function(){var e=t({id_averia:this.ticket.id_averia,descripcion:this.new_comment}),a=this;axios.post(BASE_URL+"api/averias/add_comment",e).then(function(t){a.getComments(),a.closeCommentMode(),displayMessage(t.data.mensaje)})},_deleteComment:function(t){var e=t.target.parentNode.parentNode,a=t.target.parentNode.attributes["data-id"].value,o=this;e.classList.add("to-delete"),swal({title:"Está Seguro?",text:"Seguro de que eliminar este reporte?",type:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(function(){o.deleteComment(a),e.classList.remove("to-delete")}).catch(function(){e.classList.remove("to-delete")})},deleteComment:function(e){var a=this,o=t({id_reporte:e});axios.post(BASE_URL+"api/averias/delete_comment",o).then(function(t){a.getComments(),displayMessage(t.data.mensaje)})},editComment:function(){},closeCommentMode:function(){this.mode.newComment=!1,this.new_comment=""},getComments:function(){var e=t({id_averia:this.ticket.id_averia}),a=this;axios.post(BASE_URL+"api/averias/get_comments",e).then(function(t){a.comments=t.data.comments})},updateDescription:function(){this.updateTicket(["id_averia","descripcion","tecnico","estado","fecha_reparacion"])},updateState:function(){"por reparar"==this.ticket.estado?this.ticket.fecha_reparacion="":this.ticket.fecha_reparacion=moment().format("YYYY-MM-DD")},updateTicket:function(a){this.closeEditMode();var o=t(this.getFields(a));axios.post(BASE_URL+"api/averias/update_averia",o).then(function(t){e.search(),displayMessage(t.data.mensaje)})},deleteTicket:function(){console.info("deleted")},closeEditMode:function(){this.mode.edit=!1},enterEditMode:function(){this.mode.edit=!0},getFields:function(t){var e={},a=this;return t.forEach(function(t){e[t]=a.ticket[t]},this),e}}})}();
//# sourceMappingURL=components.js.map
