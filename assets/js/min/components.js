"use strict";function isCurrentPage(e){return getCurrentPage()==e}function getCurrentPage(){var e=$("title").text().split(" ");return e=e[4].toLowerCase().trim()}function fillBSTable(e,t){var a=$(e);a.bootstrapTable("destroy"),a.find("tbody").html(t),a.bootstrapTable(),$(".pull-right.search").addClass("hide"),a.find("tbody").css({display:"table-row-group"}),a.addClass("innertable")}function filterBSTable(e,t){$(e).bootstrapTable("filterBy",{estado:t})}isCurrentPage("informes")&&new Vue({el:"#cierres",data:{table:"",tableHTML:"",hasTotals:!1,totals:!1,between:{first_date:"",second_date:"",text:""}},mounted:function(){"informes"==currentPage&&this.getReport()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"caja/get_cierres/true",t).then(function(t){e.fillTable(t.data.content),e.hasTotals=!0,e.totals=t.data.acum})},fillTable:function(e){fillBSTable("#cierres-table",e)}}}),isCurrentPage("informes")&&new Vue({el:"#gastos",data:{table:"",tableHTML:"",total:"",between:{first_date:"",second_date:"",text:""}},mounted:function(){"informes"==currentPage&&this.getReport()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"caja/get_gastos/true",t).then(function(t){e.fillTable(t.data.content),e.total=t.data.acum})},fillTable:function(e){fillBSTable("#gastos-table",e)}}}),isCurrentPage("detalles")&&function(){var e="",t={id_pago:0,id_contrato:0,id_servicio:0,id_empleado:0,fecha_pago:"",concepto:"extra",detalles_extra:"",cuota:"",mora:"",monto_extra:"",total:"",estado:"",fecha_limite:"",complete_date:"",descuento:"",razon_descuento:"",deuda:"",abono_a:"",tipo:"",generado:""},a=new Vue({el:"#app-pago-extra",data:{recibo:{id_pago:0,id_contrato:0,id_servicio:0,id_empleado:0,fecha_pago:"dd/mm/yyyy",concepto:"extra",detalles_extra:"",cuota:"",mora:"",monto_extra:"",total:"",estado:"",fecha_limite:"",complete_date:"",descuento:"",razon_descuento:"",deuda:"",abono_a:"",tipo:"",generado:""},visible:!1,pagado:!1,extra:{controls:"",id_extra:"",id_servicio:"",checkbox:"",fecha:"",concepto:"",ultimo_pago:"",monto_pagado:"",monto_total:"",estado:""},firstControls:{hide:!1}},filters:{},computed:{url_recibo:function(){return BASE_URL+"process/getrecibo/"+this.recibo.id_pago},hide_recibo:function(){return"pagado"!=this.recibo.estado&&(this.hide_recibo=!0)},isPagado:function(){return this.pagado="pagado"==this.recibo.estado,this.pagado}},methods:{goBack:function(){extraTable.el.parents(".bootstrap-table").removeClass("hide"),this.visible=!1,this.extra={concepto:""},extraTable.refresh(e)},generatePayment:function(){if(this.pagado||0==this.recibo.id_pago){var e="data="+JSON.stringify(this.extra),t=axios.post(BASE_URL+"extra/generate_extra_payment",e);t.then(function(e){var t=e.data;displayMessage(t.mensaje),i.html(t.pagos).change()}),t.catch(function(){})}else displayMessage(MESSAGE_INFO+" Debe realizar este pago antes de crear uno nuevo")},getPayment:function(e){var t="data="+JSON.stringify({id_pago:e}),a=this;axios.post(BASE_URL+"extra/get_payment",t).then(function(e){var t=e.data;t.recibo&&(a.recibo=t.recibo)})},applyPayment:function(){0!=this.recibo.id_pago?this.sender("extra/apply_payment"):displayMessage(MESSAGE_INFO+" Debe generar un pago primero")},editPayment:function(){this.sender("extra/edit_payment")},sender:function(t){var a=this,i=this.prepareData(),o=i.info,n=i.data,r="data="+JSON.stringify(n)+"&info="+JSON.stringify(o),s=axios.post(BASE_URL+t,r);s.then(function(t){var i=t.data;i.extras&&(e=i.extras),i.mensaje&&displayMessage(i.mensaje),a.getPayments(a.extra.id_extra)}),s.catch(function(e){console.log(e)})},prepareData:function(e){return{data:{concepto:"extra -",detalles_extra:(e=this.recibo).detalles_extra,fecha_pago:e.fecha_pago,cuota:e.cuota,total:e.cuota,estado:"pagado",tipo:e.tipo,generado:!0},info:{id_extra:e.id_extra,id_pago:e.id_pago}}},getPayments:function(e){var a=this,o="data="+JSON.stringify({id_extra:e});axios.post(BASE_URL+"extra/get_extra_payment_of",o).then(function(e){var o=e.data;o.pagos||(a.recibo=t),i.html(o.pagos).change()})},deletePayment:function(){var e=this,t=this.recibo,a={id_extra:t.id_extra,id_pago:t.id_pago},i="data="+JSON.stringify(a),o=axios.post(BASE_URL+"extra/delete_payment",i);o.then(function(t){var a=t.data;displayMessage(a.mensaje),e.getPayments(e.extra.id_extra)}),o.catch(function(e){console.log(e)})}}});bus.$on("row-selected",function(t){extraTable.el.parents(".bootstrap-table").addClass("hide"),a.visible=!0,a.extra=t,e=extraTable.el.find("tbody").html(),a.getPayments(t.id_extra)});var i=$("#select-extra-payment");i.on("change",function(){var e=i.val();a.getPayment(e)})}(),isCurrentPage("notificaciones")&&new Vue({el:"#recibos",data:{table:"",tableHTML:"",total:"",between:{first_date:"",second_date:"",text:""}},mounted:function(){"notificaciones"==currentPage&&this.getReport()},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"payment/get_receipts/",t).then(function(t){e.fillTable(t.data.content),e.total=t.data.acum})},fillTable:function(e){var t=$("#receipts-table");t.bootstrapTable("destroy"),t.find("tbody").html(e),t.bootstrapTable(),t.find("tbody").css({display:"table-row-group"})}}}),isCurrentPage("reportes")&&function(){function e(e){var t=$("#ganancias-chart"),a={type:"bar",data:{labels:e.labels,datasets:[{label:"Valores",data:e.values,backgroundColor:[i.lightBlue6,i.lightBlue6,i.blue7,window.chartColors.blue,window.chartColors.green,i.blueGreen,window.chartColors.red,window.chartColors.red,window.chartColors.blue]}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{callback:function(e,t,a){return""!=e&&null!=e||(e=0),"RD$ "+CurrencyFormat(e)}}}],xAxes:[{ticks:{callback:function(e,t,a){return e.replace(/_/g," ")}}}]},tooltips:{callbacks:{label:function(e,t){return"RD$ "+CurrencyFormat(e.yLabel)}}},title:{display:!0,text:"Datos del ultimo cierre. hecho por "+e.autor+" el dia "+e.fecha}}};new Chart(t,a)}function t(e,t){var i=$("#ganancias-mes-chart"),o={labels:a,datasets:[{label:"Gastos",backgroundColor:window.chartColors.red,borderColor:window.chartColors.red,data:e,fill:!1},{label:"Banco(Ganancias)",fill:!1,backgroundColor:window.chartColors.blue,borderColor:window.chartColors.blue,data:t}]},n={responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{callback:function(e,t,a){return"RD$ "+CurrencyFormat(e)}}}]},tooltips:{callbacks:{label:function(e,t){return"RD$ "+CurrencyFormat(e.yLabel)}}},title:{display:!0,text:"Registros de cierre Este ultimo a√±o"}};new Chart(i,{type:"line",data:o,options:n})}"reportes"==currentPage&&function(){var a=axios.get(BASE_URL+"caja/get_last_cierre");a.then(function(t){e(t.data),n.cierre=t.data.cierre}),a.catch(function(e){});var i="data="+JSON.stringify({year:moment().format("YYYY")});axios.post(BASE_URL+"caja/get_year_info",i).then(function(e){t(e.data.gastos,e.data.ganancias)})}(),window.chartColors={red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"};var a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],i={green:"rgba(0,230,118 ,1)",blueGreen:"rgba(29,233,182 ,1)",blue7:"rgba(25,118,210 ,1)",lightBlue6:"rgba(3,155,229 ,1)",red3:"rgba(229,115,115 ,1)",deepOrange4:"rgba(255,112,67 ,1)"},o={autor:"",banco:0,dinero_real_en_caja:0,fecha:"",pago_de_facturas:0,pagos_de_extras:0,pagos_en_efectivo:0,pagos_via_banco:0,total_de_ingresos:0,total_descuadre:0},n=new Vue({el:"#app-vista-detalle",data:{cierre:o},filters:{currencyFormat:function(e){return"RD$ "+CurrencyFormat(e)}},methods:{print:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){print()})}})}(),isCurrentPage("notificaciones")&&new Vue({el:"#retiros",data:{table:"",tableHTML:"",between:{first_date:"",second_date:""}},mounted:function(){"notificaciones"==currentPage&&this.getReport()},methods:{getReport:function(){var e=this,t="data="+JSON.stringify(this.between);axios.post(BASE_URL+"contract/getCancelations/",t).then(function(t){e.fillTable(t.data.content)})},fillTable:function(e){var t=$("#cancelation-table");t.bootstrapTable("destroy"),t.find("tbody").html(e),t.bootstrapTable(),t.find("tbody").css({display:"table-row-group"})}}}),isCurrentPage("notificaciones")&&function(){function e(e){return"data="+JSON.stringify(e)}var t=new Vue({el:"#averias-list-view",data:{dataSearch:{text:"",state:"por reparar"},tickets:[],hide:!1},mounted:function(){this.itemClickListener();var e=this;busAveria.$on("tickets-listed",function(){e.itemClickListener()})},methods:{search:function(){var e=this,t="data="+JSON.stringify(this.dataSearch),a=axios.post(BASE_URL+"api/averias/search",t);a.then(function(t){e.fillAveriasList(t.data)}),a.catch(function(){console.error(res.data.mensaje)})},fillAveriasList:function(e){$("#averias-list").html(e),t.itemClickListener()},itemClickListener:function(){$("#averias-list-view .averia-item").on("click",function(){var e=$(this).find(".code").text().trim();i.getTicket(e)})}}}),a={id_averia:"",id_cliente:"",cliente:"",direccion:"",descripcion:"",celular:"",fecha:"",estado:"",fecha_reparacion:"",tecnico:"",codigo:""},i=new Vue({el:"#ticket-view",data:{classes:{hide:!0},mode:{newComment:!1,edit:!1},new_comment:"",comments:[],ticket:a},created:function(){$("#ticket-view").removeClass("invisible")},methods:{getTicket:function(e){var a="data="+JSON.stringify({id_averia:e});axios.post(BASE_URL+"api/averias/get_averia",a).then(function(e){var a=e.data;i.classes.hide=!1,t.hide=!0,i.ticket=a.ticket,i.comments=a.comments})},quit:function(){this.ticket=a,this.comments=null,this.classes.hide=!0,this.closeCommentMode(),t.hide=!1},print:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){print()}),startComment:function(){this.mode.newComment=!0},addComment:function(){var t=e({id_averia:this.ticket.id_averia,descripcion:this.new_comment}),a=this;axios.post(BASE_URL+"api/averias/add_comment",t).then(function(e){a.getComments(),a.closeCommentMode(),displayMessage(e.data.mensaje)})},_deleteComment:function(e){var t=e.target.parentNode.parentNode,a=e.target.parentNode.attributes["data-id"].value,i=this;t.classList.add("to-delete"),swal({title:"Est√° Seguro?",text:"Seguro de que eliminar este reporte?",type:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(function(){i.deleteComment(a),t.classList.remove("to-delete")}).catch(function(){t.classList.remove("to-delete")})},deleteComment:function(t){var a=this,i=e({id_reporte:t});axios.post(BASE_URL+"api/averias/delete_comment",i).then(function(e){a.getComments(),displayMessage(e.data.mensaje)})},editComment:function(){},closeCommentMode:function(){this.mode.newComment=!1,this.new_comment=""},getComments:function(){var t=e({id_averia:this.ticket.id_averia}),a=this;axios.post(BASE_URL+"api/averias/get_comments",t).then(function(e){a.comments=e.data.comments})},updateDescription:function(){this.updateTicket(["id_averia","descripcion","tecnico","estado","fecha_reparacion"])},updateState:function(){"por reparar"==this.ticket.estado?this.ticket.fecha_reparacion="":this.ticket.fecha_reparacion=moment().format("YYYY-MM-DD")},updateTicket:function(a){this.closeEditMode();var i=e(this.getFields(a));axios.post(BASE_URL+"api/averias/update_averia",i).then(function(e){t.search(),displayMessage(e.data.mensaje)})},deleteTicket:function(){console.info("deleted")},closeEditMode:function(){this.mode.edit=!1},enterEditMode:function(){this.mode.edit=!0},getFields:function(e){var t={},a=this;return e.forEach(function(e){t[e]=a.ticket[e]},this),t}}})}();
//# sourceMappingURL=components.js.map
