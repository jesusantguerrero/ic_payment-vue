function getForm(e){return"data="+JSON.stringify(e)}var configMessage={email:"",password:"",device_id:"",country_code:"",send_at:"1 second",expires_at:"1 hour"},configMessagesForm=new Vue({el:"#message-settings-section",data:{config:configMessage},mounted:function(){this.getConfig()},methods:{confirmPhone:function(){},getConfig:function(){var e,t=this;(e=axios.get(BASE_URL+"messages/get_config")).then(function(e){e.data.config&&(t.config=e.data.config)}),e.catch(function(e){console.log(e)})},saveSettings:function(e){var t,i,s;t=this.config,i="data="+JSON.stringify(t),(s=axios.post(BASE_URL+"messages/save_config",i)).then(function(e){displayMessage(e.data.mensaje)}),s.catch(function(e){console.log(e)})}}}),sendMessageApp=new Vue({el:"#send-message-modal",data:{hide_clients:!0,hide_numbers:!0,message_data:{tipo:"",clientes:"",numeros:"",mensaje:""}},mounted:function(){this.initSelect2()},computed:{letters_count:function(){return this.message_data.mensaje.length}},methods:{sendMessage:function(){var e,t;isEmpty([this.message_data.tipo,this.message_data.mensaje])?swal("Campos Requeridos","Por favor selecciones el tipo de mensaje y escriba su mensaje"):(e="data="+JSON.stringify(this.message_data),(t=axios.post(BASE_URL+"messages/send_message",e)).then(function(e){displayMessage(e.data.mensaje)}),t.catch(function(e){console.log(e)}))},initSelect2:function(){var e={dropdownParent:$("#send-message-modal")},t=$("#message-type");t.select2(e);var i={clients:$("#clients-for-message").select2({dropdownParent:$("#send-message-modal"),ajax:{url:BASE_URL+"messages/search_clients",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e.items,pagination:{more:30*t.page<e.total_count}}},cache:!0}}),messageType:t};this.selec2Liteners(i)},selec2Liteners:function(e){var t=this;e.messageType.on("select2:select",function(e){e.params.data.element.attributes;var i=e.params.data.id;t.message_data.tipo=i,"otros"==i?(t.hide_clients=!0,t.hide_numbers=!1):"personalizado"==i?(t.hide_numbers=!0,t.hide_clients=!1):(t.hide_clients=!0,t.hide_numbers=!0)}),e.messageType.select2("val","mora"),e.clients.on("select2:select",function(i){for(var s=e.clients.select2("data"),a=[],n=0;n<s.length;n++)a.push({nombre_completo:s[n].text,celular:s[n].id});t.message_data.clientes=a})}}}),RetirementReport=new Vue({el:"#retiros",data:{table:"",tableHTML:"",between:{first_date:"",second_date:""}},methods:{getReport:function(){JSON.stringify(this.between);axios.post(BASE_URL+"contract/getCancelations/").then(function(e){console.log(e)})},fillTable:function(e){}}}),ticketListView=new Vue({el:"#averias-list-view",data:{dataSearch:{text:"",state:"por reparar"},tickets:[],hide:!1},mounted:function(){this.itemClickListener();var e=this;busAveria.$on("tickets-listed",function(){e.itemClickListener()})},methods:{search:function(){var e="data="+JSON.stringify(this.dataSearch),t=axios.post(BASE_URL+"api/averias/search",e);t.then(function(e){this.fillAveriasList(e.data)}),t.catch(function(){console.error(res.data.mensaje)})},fillAveriasList:function(e){$("#averia-item-list").html(e),ticketListView.itemClickListener()},itemClickListener:function(){$("#averias-list-view .averia-item").on("click",function(){var e=$(this).find(".code").text().trim();ticketView.getTicket(e)})}}}),emptyTicket={id_averia:"",id_cliente:"",cliente:"",direccion:"",descripcion:"",celular:"",fecha:"",estado:"",fecha_reparacion:"",tecnico:"",codigo:""},ticketView=new Vue({el:"#ticket-view",data:{classes:{hide:!0},mode:{newComment:!1,edit:!1},new_comment:"",comments:[],ticket:emptyTicket},created:function(){$("#ticket-view").removeClass("invisible")},methods:{getTicket:function(e){var t="data="+JSON.stringify({id_averia:e});axios.post(BASE_URL+"api/averias/get_averia",t).then(function(e){var t=e.data;ticketView.classes.hide=!1,ticketListView.hide=!0,ticketView.ticket=t.ticket,ticketView.comments=t.comments})},quit:function(){this.ticket=emptyTicket,this.comments=null,this.classes.hide=!0,this.closeCommentMode(),ticketListView.hide=!1},print:function(){print()},startComment:function(){this.mode.newComment=!0},addComment:function(){var e=getForm({id_averia:this.ticket.id_averia,descripcion:this.new_comment}),t=this;axios.post(BASE_URL+"api/averias/add_comment",e).then(function(e){t.getComments(),t.closeCommentMode(),displayMessage(e.data.mensaje)})},_deleteComment:function(e){var t=e.target.parentNode.parentNode,i=e.target.parentNode.attributes["data-id"].value,s=this;t.classList.add("to-delete"),swal({title:"EstÃ¡ Seguro?",text:"Seguro de que eliminar este reporte?",type:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(function(){s.deleteComment(i),t.classList.remove("to-delete")}).catch(function(){t.classList.remove("to-delete")})},deleteComment:function(e){var t=this,i=getForm({id_reporte:e});axios.post(BASE_URL+"api/averias/delete_comment",i).then(function(e){t.getComments(),displayMessage(e.data.mensaje)})},editComment:function(){},closeCommentMode:function(){this.mode.newComment=!1,this.new_comment=""},getComments:function(){var e=getForm({id_averia:this.ticket.id_averia}),t=this;axios.post(BASE_URL+"api/averias/get_comments",e).then(function(e){t.comments=e.data.comments})},updateDescription:function(){this.updateTicket(["id_averia","descripcion","tecnico","estado","fecha_reparacion"])},updateState:function(){"por reparar"==this.ticket.estado?this.ticket.fecha_reparacion="":this.ticket.fecha_reparacion=moment().format("YYYY-MM-DD")},updateTicket:function(e){this.closeEditMode();var t=getForm(this.getFields(e));axios.post(BASE_URL+"api/averias/update_averia",t).then(function(e){ticketListView.search(),displayMessage(e.data.mensaje)})},deleteTicket:function(){console.info("deleted")},closeEditMode:function(){this.mode.edit=!1},enterEditMode:function(){this.mode.edit=!0},getFields:function(e){var t={},i=this;return e.forEach(function(e){t[e]=i.ticket[e]},this),t}}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRpY2tldHMuanMiLCJNZXNzYWdlcy5qcyIsIlJldGlyZW1lbnRzLmpzIl0sIm5hbWVzIjpbImdldEZvcm0iLCJvYmplY3QiLCJKU09OIiwic3RyaW5naWZ5IiwiY29uZmlnTWVzc2FnZSIsImVtYWlsIiwicGFzc3dvcmQiLCJkZXZpY2VfaWQiLCJjb3VudHJ5X2NvZGUiLCJzZW5kX2F0IiwiZXhwaXJlc19hdCIsImNvbmZpZ01lc3NhZ2VzRm9ybSIsIlZ1ZSIsImVsIiwiZGF0YSIsImNvbmZpZyIsIm1vdW50ZWQiLCJ0aGlzIiwiZ2V0Q29uZmlnIiwibWV0aG9kcyIsImNvbmZpcm1QaG9uZSIsInNlbmQiLCJzZWxmIiwiYXhpb3MiLCJnZXQiLCJCQVNFX1VSTCIsInRoZW4iLCJyZXMiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInNhdmVTZXR0aW5ncyIsImUiLCJmb3JtIiwicG9zdCIsImRpc3BsYXlNZXNzYWdlIiwibWVuc2FqZSIsImVyciIsInNlbmRNZXNzYWdlQXBwIiwiaGlkZV9jbGllbnRzIiwiaGlkZV9udW1iZXJzIiwibWVzc2FnZV9kYXRhIiwidGlwbyIsImNsaWVudGVzIiwibnVtZXJvcyIsImluaXRTZWxlY3QyIiwiY29tcHV0ZWQiLCJsZXR0ZXJzX2NvdW50IiwibGVuZ3RoIiwic2VuZE1lc3NhZ2UiLCJpc0VtcHR5Iiwic3dhbCIsIm9wdGlvbnMiLCJkcm9wZG93blBhcmVudCIsIiQiLCJzZWxlY3RNZXNzYWdlVHlwZSIsInNlbGVjdDIiLCJzZWxlY3RzIiwiY2xpZW50cyIsImFqYXgiLCJ1cmwiLCJkYXRhVHlwZSIsImRlbGF5IiwicGFyYW1zIiwicSIsInRlcm0iLCJwYWdlIiwicHJvY2Vzc1Jlc3VsdHMiLCJyZXN1bHRzIiwiaXRlbXMiLCJwYWdpbmF0aW9uIiwibW9yZSIsInRvdGFsX2NvdW50IiwiY2FjaGUiLCJtZXNzYWdlVHlwZSIsInNlbGVjMkxpdGVuZXJzIiwib24iLCJlbGVtZW50IiwiYXR0cmlidXRlcyIsImlkIiwiaSIsInB1c2giLCJub21icmVfY29tcGxldG8iLCJ0ZXh0IiwiY2VsdWxhciIsIlJldGlyZW1lbnRSZXBvcnQiLCJ0YWJsZSIsInRhYmxlSFRNTCIsImJldHdlZW4iLCJmaXJzdF9kYXRlIiwic2Vjb25kX2RhdGUiLCJnZXRSZXBvcnQiLCJmaWxsVGFibGUiLCJkYXRhSFRNTCIsInRpY2tldExpc3RWaWV3IiwiZGF0YVNlYXJjaCIsInN0YXRlIiwidGlja2V0cyIsImhpZGUiLCJpdGVtQ2xpY2tMaXN0ZW5lciIsImJ1c0F2ZXJpYSIsIiRvbiIsInNlYXJjaCIsImZpbGxBdmVyaWFzTGlzdCIsIiRjb250ZW50IiwiaHRtbCIsImlkX2F2ZXJpYSIsImZpbmQiLCJ0cmltIiwidGlja2V0VmlldyIsImdldFRpY2tldCIsImVtcHR5VGlja2V0IiwiaWRfY2xpZW50ZSIsImNsaWVudGUiLCJkaXJlY2Npb24iLCJkZXNjcmlwY2lvbiIsImZlY2hhIiwiZXN0YWRvIiwiZmVjaGFfcmVwYXJhY2lvbiIsInRlY25pY28iLCJjb2RpZ28iLCJjbGFzc2VzIiwibW9kZSIsIm5ld0NvbW1lbnQiLCJlZGl0IiwibmV3X2NvbW1lbnQiLCJjb21tZW50cyIsInRpY2tldCIsImNyZWF0ZWQiLCJyZW1vdmVDbGFzcyIsInF1aXQiLCJjbG9zZUNvbW1lbnRNb2RlIiwicHJpbnQiLCJzdGFydENvbW1lbnQiLCJhZGRDb21tZW50IiwiZ2V0Q29tbWVudHMiLCJfZGVsZXRlQ29tbWVudCIsImNvbW1lbnRJdGVtIiwidGFyZ2V0IiwicGFyZW50Tm9kZSIsImlkQ29tbWVudCIsInZhbHVlIiwiY2xhc3NMaXN0IiwiYWRkIiwidGl0bGUiLCJ0eXBlIiwic2hvd0NhbmNlbEJ1dHRvbiIsImNvbmZpcm1CdXR0b25UZXh0IiwiY2FuY2VsQnV0dG9uVGV4dCIsImRlbGV0ZUNvbW1lbnQiLCJyZW1vdmUiLCJpZF9yZXBvcnRlIiwiZWRpdENvbW1lbnQiLCJ1cGRhdGVEZXNjcmlwdGlvbiIsInVwZGF0ZVRpY2tldCIsInVwZGF0ZVN0YXRlIiwibW9tZW50IiwiZm9ybWF0IiwiZmllbGRzIiwiY2xvc2VFZGl0TW9kZSIsImdldEZpZWxkcyIsImRlbGV0ZVRpY2tldCIsImluZm8iLCJlbnRlckVkaXRNb2RlIiwic2VsZWN0ZWRGaWVsZHMiLCJmb3JFYWNoIiwiZmllbGQiXSwibWFwcGluZ3MiOiJBQWdPQSxTQUFBQSxRQUFBQyxHQUNBLE1BQUEsUUFBQUMsS0FBQUMsVUFBQUYsR0NoT0EsSUFBQUcsZUFDQUMsTUFBQSxHQUNBQyxTQUFBLEdBQ0FDLFVBQUEsR0FDQUMsYUFBQSxHQUNBQyxRQUFBLFdBQ0FDLFdBQUEsVUFHQUMsbUJBQUEsSUFBQUMsS0FDQUMsR0FBQSw0QkFDQUMsTUFDQUMsT0FBQVgsZUFFQVksUUFBQSxXQUNBQyxLQUFBQyxhQUdBQyxTQUNBQyxhQUFBLGFBRUFGLFVBQUEsV0FDQSxJQUFBRyxFQUNBQyxFQUFBTCxNQUNBSSxFQUFBRSxNQUFBQyxJQUFBQyxTQUFBLHdCQUNBQyxLQUFBLFNBQUFDLEdBQ0FBLEVBQUFiLEtBQUFDLFNBQ0FPLEVBQUFQLE9BQUFZLEVBQUFiLEtBQUFDLFVBR0FNLEVBQUFPLE1BQUEsU0FBQUMsR0FDQUMsUUFBQUMsSUFBQUYsTUFJQUcsYUFBQSxTQUFBQyxHQUNBLElBQUFsQixFQUFBbUIsRUFBQWIsRUFDQU4sRUFBQUUsS0FBQUYsT0FFQW1CLEVBQUEsUUFBQWhDLEtBQUFDLFVBQUFZLElBQ0FNLEVBQUFFLE1BQUFZLEtBQUFWLFNBQUEsdUJBQUFTLElBQ0FSLEtBQUEsU0FBQUMsR0FDQVMsZUFBQVQsRUFBQWIsS0FBQXVCLFdBRUFoQixFQUFBTyxNQUFBLFNBQUFVLEdBQ0FSLFFBQUFDLElBQUFPLFNBTUFDLGVBQUEsSUFBQTNCLEtBQ0FDLEdBQUEsc0JBRUFDLE1BQ0EwQixjQUFBLEVBQ0FDLGNBQUEsRUFFQUMsY0FDQUMsS0FBQSxHQUNBQyxTQUFBLEdBQ0FDLFFBQUEsR0FDQVIsUUFBQSxLQUlBckIsUUFBQSxXQUNBQyxLQUFBNkIsZUFHQUMsVUFDQUMsY0FBQSxXQUNBLE9BQUEv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V0FDQSxlQUFBM0ksS0FBQStHLE9BQUFWLE9BQ0FyRyxLQUFBK0csT0FBQVQsaUJBQUEsR0FFQXRHLEtBQUErRyxPQUFBVCxpQkFBQXNDLFNBQUFDLE9BQUEsZUFJQUgsYUFBQSxTQUFBSSxHQUNBOUksS0FBQStJLGdCQUNBLElBQUE5SCxFQUFBbEMsUUFBQWlCLEtBQUFnSixVQUFBRixJQUNBeEksTUFBQVksS0FBQVYsU0FBQSw0QkFBQVMsR0FFQVIsS0FBQSxTQUFBQyxHQUNBb0UsZUFBQVEsU0FDQW5FLGVBQUFULEVBQUFiLEtBQUF1QixZQUlBNkgsYUFBQSxXQUNBcEksUUFBQXFJLEtBQUEsWUFHQUgsY0FBQSxXQUNBL0ksS0FBQTBHLEtBQUFFLE1BQUEsR0FHQXVDLGNBQUEsV0FDQW5KLEtBQUEwRyxLQUFBRSxNQUFBLEdBR0FvQyxVQUFBLFNBQUFGLEdBQ0EsSUFBQU0sS0FDQS9JLEVBQUFMLEtBS0EsT0FKQThJLEVBQUFPLFFBQUEsU0FBQUMsR0FDQUYsRUFBQUUsR0FBQWpKLEVBQUEwRyxPQUFBdUMsSUFDQXRKLE1BRUFvSiIsImZpbGUiOiJjb21wb25lbnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiICB2YXIgdGlja2V0TGlzdFZpZXcgPSBuZXcgVnVlKHtcclxuICAgIGVsOiAnI2F2ZXJpYXMtbGlzdC12aWV3JyxcclxuICAgIGRhdGE6IHtcclxuICAgICAgZGF0YVNlYXJjaDoge1xyXG4gICAgICAgIHRleHQ6ICcnLFxyXG4gICAgICAgIHN0YXRlOiAncG9yIHJlcGFyYXInLFxyXG4gICAgICB9LFxyXG4gICAgICB0aWNrZXRzOiBbXSxcclxuICAgICAgaGlkZTogZmFsc2VcclxuICAgIH0sXHJcblxyXG4gICAgbW91bnRlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLml0ZW1DbGlja0xpc3RlbmVyKCk7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgICBidXNBdmVyaWEuJG9uKCd0aWNrZXRzLWxpc3RlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLml0ZW1DbGlja0xpc3RlbmVyKClcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG1ldGhvZHM6IHtcclxuICAgICAgc2VhcmNoOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZvcm0gPSAnZGF0YT0nICsgSlNPTi5zdHJpbmdpZnkodGhpcy5kYXRhU2VhcmNoKTtcclxuICAgICAgICB2YXIgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnYXBpL2F2ZXJpYXMvc2VhcmNoJywgZm9ybSk7XHJcblxyXG4gICAgICAgIHNlbmQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICB0aGlzLmZpbGxBdmVyaWFzTGlzdChyZXMuZGF0YSk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgc2VuZC5jYXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlcy5kYXRhLm1lbnNhamUpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZmlsbEF2ZXJpYXNMaXN0OiBmdW5jdGlvbiAoJGNvbnRlbnQpIHtcclxuICAgICAgICAkKCcjYXZlcmlhLWl0ZW0tbGlzdCcpLmh0bWwoJGNvbnRlbnQpO1xyXG4gICAgICAgIHRpY2tldExpc3RWaWV3Lml0ZW1DbGlja0xpc3RlbmVyKCk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBpdGVtQ2xpY2tMaXN0ZW5lcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoJyNhdmVyaWFzLWxpc3QtdmlldyAuYXZlcmlhLWl0ZW0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgaWRfYXZlcmlhID0gJCh0aGlzKS5maW5kKCcuY29kZScpLnRleHQoKS50cmltKCk7XHJcbiAgICAgICAgICB0aWNrZXRWaWV3LmdldFRpY2tldChpZF9hdmVyaWEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgdmFyIGVtcHR5VGlja2V0ID0ge1xyXG4gICAgXCJpZF9hdmVyaWFcIjogXCJcIixcclxuICAgIFwiaWRfY2xpZW50ZVwiOiBcIlwiLFxyXG4gICAgXCJjbGllbnRlXCI6IFwiXCIsXHJcbiAgICBcImRpcmVjY2lvblwiOiBcIlwiLFxyXG4gICAgXCJkZXNjcmlwY2lvblwiOiBcIlwiLFxyXG4gICAgXCJjZWx1bGFyXCI6IFwiXCIsXHJcbiAgICBcImZlY2hhXCI6IFwiXCIsXHJcbiAgICBcImVzdGFkb1wiOiBcIlwiLFxyXG4gICAgXCJmZWNoYV9yZXBhcmFjaW9uXCI6IFwiXCIsXHJcbiAgICBcInRlY25pY29cIjogXCJcIixcclxuICAgIFwiY29kaWdvXCI6ICcnLFxyXG4gIH1cclxuICBcclxuICB2YXIgdGlja2V0VmlldyA9IG5ldyBWdWUoe1xyXG4gICAgZWw6ICcjdGlja2V0LXZpZXcnLFxyXG4gICAgXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgIGNsYXNzZXM6IHtcclxuICAgICAgICBoaWRlOiB0cnVlXHJcbiAgICAgIH0sXHJcbiAgICAgIG1vZGU6IHtcclxuICAgICAgICBuZXdDb21tZW50OiBmYWxzZSxcclxuICAgICAgICBlZGl0OiBmYWxzZSxcclxuICAgICAgfSxcclxuICAgICAgbmV3X2NvbW1lbnQ6ICcnLFxyXG4gICAgICBjb21tZW50czogW10sXHJcbiAgICAgIHRpY2tldDogZW1wdHlUaWNrZXRcclxuICAgIH0sXHJcbiAgICBjcmVhdGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICQoJyN0aWNrZXQtdmlldycpLnJlbW92ZUNsYXNzKCdpbnZpc2libGUnKVxyXG4gICAgfSxcclxuXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgIGdldFRpY2tldDogZnVuY3Rpb24gKGlkX2F2ZXJpYSkge1xyXG4gICAgICAgIHZhciBmb3JtID0gJ2RhdGE9JyArIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGlkX2F2ZXJpYTogaWRfYXZlcmlhXHJcbiAgICAgICAgfSlcclxuICAgICAgICB2YXIgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnYXBpL2F2ZXJpYXMvZ2V0X2F2ZXJpYScsIGZvcm0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHNlbmQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICB2YXIgZGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgdGlja2V0Vmlldy5jbGFzc2VzLmhpZGUgPSBmYWxzZTtcclxuICAgICAgICAgIHRpY2tldExpc3RWaWV3LmhpZGUgPSB0cnVlO1xyXG4gICAgICAgICAgdGlja2V0Vmlldy50aWNrZXQgPSBkYXRhLnRpY2tldDtcclxuICAgICAgICAgIHRpY2tldFZpZXcuY29tbWVudHMgPSBkYXRhLmNvbW1lbnRzO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBxdWl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy50aWNrZXQgPSBlbXB0eVRpY2tldDtcclxuICAgICAgICB0aGlzLmNvbW1lbnRzID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNsYXNzZXMuaGlkZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jbG9zZUNvbW1lbnRNb2RlKCk7XHJcbiAgICAgICAgdGlja2V0TGlzdFZpZXcuaGlkZSA9IGZhbHNlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgcHJpbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBwcmludCgpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgc3RhcnRDb21tZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlLm5ld0NvbW1lbnQgPSB0cnVlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQ29tbWVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmb3JtID0gZ2V0Rm9ybSh7aWRfYXZlcmlhOiB0aGlzLnRpY2tldC5pZF9hdmVyaWEsIGRlc2NyaXBjaW9uOiB0aGlzLm5ld19jb21tZW50fSk7XHJcbiAgICAgICAgdmFyIHNlbmQgPSBheGlvcy5wb3N0KEJBU0VfVVJMICsgJ2FwaS9hdmVyaWFzL2FkZF9jb21tZW50Jyxmb3JtKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VuZC50aGVuKCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICBzZWxmLmdldENvbW1lbnRzKCk7XHJcbiAgICAgICAgICBzZWxmLmNsb3NlQ29tbWVudE1vZGUoKVxyXG4gICAgICAgICAgZGlzcGxheU1lc3NhZ2UocmVzLmRhdGEubWVuc2FqZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBfZGVsZXRlQ29tbWVudDogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB2YXIgY29tbWVudEl0ZW0gPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGVcclxuICAgICAgICB2YXIgaWRDb21tZW50ID0gZS50YXJnZXQucGFyZW50Tm9kZS5hdHRyaWJ1dGVzWydkYXRhLWlkJ10udmFsdWVcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tbWVudEl0ZW0uY2xhc3NMaXN0LmFkZCgndG8tZGVsZXRlJyk7XHJcblxyXG4gICAgICAgIHN3YWwoe1xyXG4gICAgICAgICAgdGl0bGU6ICdFc3TDoSBTZWd1cm8/JyxcclxuICAgICAgICAgIHRleHQ6IFwiU2VndXJvIGRlIHF1ZSBlbGltaW5hciBlc3RlIHJlcG9ydGU/XCIsXHJcbiAgICAgICAgICB0eXBlOiAnd2FybmluZycsXHJcbiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxyXG4gICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdFbGltaW5hcicsXHJcbiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnQ2FuY2VsYXInXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbihmdW5jdGlvbigpe1xyXG4gICAgICAgICAgc2VsZi5kZWxldGVDb21tZW50KGlkQ29tbWVudCk7XHJcbiAgICAgICAgICBjb21tZW50SXRlbS5jbGFzc0xpc3QucmVtb3ZlKCd0by1kZWxldGUnKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIGNvbW1lbnRJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3RvLWRlbGV0ZScpXHJcbiAgICAgICAgfSlcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGRlbGV0ZUNvbW1lbnQ6IGZ1bmN0aW9uIChpZENvbW1lbnQpe1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZm9ybSA9IGdldEZvcm0oeyBpZF9yZXBvcnRlOiBpZENvbW1lbnR9KTtcclxuICAgICAgICB2YXIgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnYXBpL2F2ZXJpYXMvZGVsZXRlX2NvbW1lbnQnLGZvcm0pO1xyXG5cclxuICAgICAgICBzZW5kLnRoZW4oIGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgIHNlbGYuZ2V0Q29tbWVudHMoKTtcclxuICAgICAgICAgIGRpc3BsYXlNZXNzYWdlKHJlcy5kYXRhLm1lbnNhamUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZWRpdENvbW1lbnQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIH0sXHJcbiAgICAgIFxyXG4gICAgICBjbG9zZUNvbW1lbnRNb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlLm5ld0NvbW1lbnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5ld19jb21tZW50ID0gJyc7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBnZXRDb21tZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmb3JtID0gZ2V0Rm9ybSh7aWRfYXZlcmlhOiB0aGlzLnRpY2tldC5pZF9hdmVyaWF9KTtcclxuICAgICAgICB2YXIgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnYXBpL2F2ZXJpYXMvZ2V0X2NvbW1lbnRzJyxmb3JtKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXNcclxuICAgICAgICBzZW5kLnRoZW4oIGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgIHNlbGYuY29tbWVudHMgPSByZXMuZGF0YS5jb21tZW50cztcclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVwZGF0ZURlc2NyaXB0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVUaWNrZXQoWydpZF9hdmVyaWEnLCdkZXNjcmlwY2lvbicsJ3RlY25pY28nLCdlc3RhZG8nLCdmZWNoYV9yZXBhcmFjaW9uJ10pO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgdXBkYXRlU3RhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy50aWNrZXQuZXN0YWRvID09ICdwb3IgcmVwYXJhcicpIHtcclxuICAgICAgICAgIHRoaXMudGlja2V0LmZlY2hhX3JlcGFyYWNpb24gPSAnJ1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLnRpY2tldC5mZWNoYV9yZXBhcmFjaW9uID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgdXBkYXRlVGlja2V0OiBmdW5jdGlvbiAoZmllbGRzKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZUVkaXRNb2RlKCk7XHJcbiAgICAgICAgdmFyIGZvcm0gPSBnZXRGb3JtKHRoaXMuZ2V0RmllbGRzKGZpZWxkcykpO1xyXG4gICAgICAgIHZhciBzZW5kID0gYXhpb3MucG9zdChCQVNFX1VSTCArICdhcGkvYXZlcmlhcy91cGRhdGVfYXZlcmlhJyxmb3JtKTtcclxuXHJcbiAgICAgICAgc2VuZC50aGVuKCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICB0aWNrZXRMaXN0Vmlldy5zZWFyY2goKTtcclxuICAgICAgICAgIGRpc3BsYXlNZXNzYWdlKHJlcy5kYXRhLm1lbnNhamUpXHJcbiAgICAgICAgfSlcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGRlbGV0ZVRpY2tldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnZGVsZXRlZCcpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgY2xvc2VFZGl0TW9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubW9kZS5lZGl0ID0gZmFsc2U7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBlbnRlckVkaXRNb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlLmVkaXQgPSB0cnVlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0RmllbGRzOiBmdW5jdGlvbiAoZmllbGRzKSB7XHJcbiAgICAgICAgdmFyIHNlbGVjdGVkRmllbGRzID0ge307XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uKGZpZWxkKSB7XHJcbiAgICAgICAgICBzZWxlY3RlZEZpZWxkc1tmaWVsZF0gPSBzZWxmLnRpY2tldFtmaWVsZF1cclxuICAgICAgICB9LCB0aGlzKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkRmllbGRzO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIGZ1bmN0aW9uIGdldEZvcm0ob2JqZWN0KXtcclxuICAgIHJldHVybiBcImRhdGE9XCIgKyBKU09OLnN0cmluZ2lmeShvYmplY3QpO1xyXG4gIH1cclxuIiwiXHJcbnZhciBjb25maWdNZXNzYWdlID0ge1xyXG4gIGVtYWlsOiAnJyxcclxuICBwYXNzd29yZDogJycsXHJcbiAgZGV2aWNlX2lkOiAnJyxcclxuICBjb3VudHJ5X2NvZGU6ICcnLFxyXG4gIHNlbmRfYXQ6ICcxIHNlY29uZCcsXHJcbiAgZXhwaXJlc19hdDogJzEgaG91cidcclxufVxyXG5cclxudmFyIGNvbmZpZ01lc3NhZ2VzRm9ybSA9IG5ldyBWdWUoe1xyXG4gIGVsOiAnI21lc3NhZ2Utc2V0dGluZ3Mtc2VjdGlvbicsXHJcbiAgZGF0YToge1xyXG4gICAgY29uZmlnOiBjb25maWdNZXNzYWdlXHJcbiAgfSxcclxuICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdldENvbmZpZygpXHJcbiAgfSxcclxuXHJcbiAgbWV0aG9kczoge1xyXG4gICAgY29uZmlybVBob25lOiBmdW5jdGlvbiAoKSB7fSxcclxuXHJcbiAgICBnZXRDb25maWc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHNlbmRcclxuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICBzZW5kID0gYXhpb3MuZ2V0KEJBU0VfVVJMICsgJ21lc3NhZ2VzL2dldF9jb25maWcnKVxyXG4gICAgICBzZW5kLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIGlmKHJlcy5kYXRhLmNvbmZpZyl7XHJcbiAgICAgICAgICBzZWxmLmNvbmZpZyA9IHJlcy5kYXRhLmNvbmZpZ1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgc2VuZC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgfSlcclxuICAgIH0sXHJcblxyXG4gICAgc2F2ZVNldHRpbmdzOiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICB2YXIgY29uZmlnLCBmb3JtLCBzZW5kXHJcbiAgICAgIGNvbmZpZyA9IHRoaXMuY29uZmlnXHJcblxyXG4gICAgICBmb3JtID0gJ2RhdGE9JyArIEpTT04uc3RyaW5naWZ5KGNvbmZpZylcclxuICAgICAgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnbWVzc2FnZXMvc2F2ZV9jb25maWcnLCBmb3JtKVxyXG4gICAgICBzZW5kLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIGRpc3BsYXlNZXNzYWdlKHJlcy5kYXRhLm1lbnNhamUpXHJcbiAgICAgIH0pXHJcbiAgICAgIHNlbmQuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcbn0pXHJcblxyXG52YXIgc2VuZE1lc3NhZ2VBcHAgPSBuZXcgVnVlKHtcclxuICBlbDogJyNzZW5kLW1lc3NhZ2UtbW9kYWwnLFxyXG5cclxuICBkYXRhOiB7XHJcbiAgICBoaWRlX2NsaWVudHM6IHRydWUsXHJcbiAgICBoaWRlX251bWJlcnM6IHRydWUsXHJcblxyXG4gICAgbWVzc2FnZV9kYXRhOiB7XHJcbiAgICAgIHRpcG86ICcnLFxyXG4gICAgICBjbGllbnRlczogJycsXHJcbiAgICAgIG51bWVyb3M6ICcnLFxyXG4gICAgICBtZW5zYWplOiAnJ1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuaW5pdFNlbGVjdDIoKVxyXG4gIH0sXHJcblxyXG4gIGNvbXB1dGVkOiB7XHJcbiAgICBsZXR0ZXJzX2NvdW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VfZGF0YS5tZW5zYWplLmxlbmd0aFxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG1ldGhvZHM6IHtcclxuICAgIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBmb3JtLCBzZW5kXHJcblxyXG4gICAgICBpZiAoIWlzRW1wdHkoW3RoaXMubWVzc2FnZV9kYXRhLnRpcG8sIHRoaXMubWVzc2FnZV9kYXRhLm1lbnNhamVdKSkge1xyXG4gICAgICAgIGZvcm0gPSAnZGF0YT0nICsgSlNPTi5zdHJpbmdpZnkodGhpcy5tZXNzYWdlX2RhdGEpXHJcbiAgICAgICAgc2VuZCA9IGF4aW9zLnBvc3QoQkFTRV9VUkwgKyAnbWVzc2FnZXMvc2VuZF9tZXNzYWdlJywgZm9ybSlcclxuICAgICAgICBzZW5kLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgZGlzcGxheU1lc3NhZ2UocmVzLmRhdGEubWVuc2FqZSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIHNlbmQuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHN3YWwoJ0NhbXBvcyBSZXF1ZXJpZG9zJywgJ1BvciBmYXZvciBzZWxlY2Npb25lcyBlbCB0aXBvIGRlIG1lbnNhamUgeSBlc2NyaWJhIHN1IG1lbnNhamUnKVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRTZWxlY3QyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgICB2YXIgb3B0aW9ucyA9IHtcclxuICAgICAgICBkcm9wZG93blBhcmVudDogJCgnI3NlbmQtbWVzc2FnZS1tb2RhbCcpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBzZWxlY3RNZXNzYWdlVHlwZSA9ICQoJyNtZXNzYWdlLXR5cGUnKVxyXG4gICAgICBzZWxlY3RNZXNzYWdlVHlwZS5zZWxlY3QyKG9wdGlvbnMpXHJcbiAgICAgIHZhciBzZWxlY3RDbGllbnRzRm9yTWVzc2FnZSA9ICQoJyNjbGllbnRzLWZvci1tZXNzYWdlJykuc2VsZWN0Mih7XHJcbiAgICAgICAgZHJvcGRvd25QYXJlbnQ6ICQoJyNzZW5kLW1lc3NhZ2UtbW9kYWwnKSxcclxuICAgICAgICBhamF4OiB7XHJcbiAgICAgICAgICB1cmw6IEJBU0VfVVJMICsgJ21lc3NhZ2VzL3NlYXJjaF9jbGllbnRzJyxcclxuICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICBkZWxheTogMjUwLFxyXG4gICAgICAgICAgZGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgIHE6IHBhcmFtcy50ZXJtLFxyXG4gICAgICAgICAgICAgIHBhZ2U6IHBhcmFtcy5wYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgcHJvY2Vzc1Jlc3VsdHM6IGZ1bmN0aW9uIChkYXRhLCBwYXJhbXMpIHtcclxuICAgICAgICAgICAgcGFyYW1zLnBhZ2UgPSBwYXJhbXMucGFnZSB8fCAxXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgcmVzdWx0czogZGF0YS5pdGVtcyxcclxuICAgICAgICAgICAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgICAgICAgICBtb3JlOiAocGFyYW1zLnBhZ2UgKiAzMCkgPCBkYXRhLnRvdGFsX2NvdW50XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY2FjaGU6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICB2YXIgc2VsZWN0cyA9IHtcclxuICAgICAgICBjbGllbnRzOiBzZWxlY3RDbGllbnRzRm9yTWVzc2FnZSxcclxuICAgICAgICBtZXNzYWdlVHlwZTogc2VsZWN0TWVzc2FnZVR5cGVcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNlbGVjMkxpdGVuZXJzKHNlbGVjdHMpXHJcbiAgICB9LFxyXG5cclxuICAgIHNlbGVjMkxpdGVuZXJzOiBmdW5jdGlvbiAoc2VsZWN0cykge1xyXG4gICAgICB2YXIgc2VsZiA9IHRoaXNcclxuICAgICAgc2VsZWN0cy5tZXNzYWdlVHlwZS5vbignc2VsZWN0MjpzZWxlY3QnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHZhciBzZWxlY3QgPSBlLnBhcmFtcy5kYXRhLmVsZW1lbnRcclxuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IHNlbGVjdC5hdHRyaWJ1dGVzXHJcbiAgICAgICAgdmFyIHRpcG8gPSBlLnBhcmFtcy5kYXRhLmlkXHJcbiAgICAgICAgc2VsZi5tZXNzYWdlX2RhdGEudGlwbyA9IHRpcG9cclxuXHJcbiAgICAgICAgaWYgKHRpcG8gPT0gJ290cm9zJykge1xyXG4gICAgICAgICAgc2VsZi5oaWRlX2NsaWVudHMgPSB0cnVlXHJcbiAgICAgICAgICBzZWxmLmhpZGVfbnVtYmVycyA9IGZhbHNlXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aXBvID09ICdwZXJzb25hbGl6YWRvJykge1xyXG4gICAgICAgICAgc2VsZi5oaWRlX251bWJlcnMgPSB0cnVlXHJcbiAgICAgICAgICBzZWxmLmhpZGVfY2xpZW50cyA9IGZhbHNlXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNlbGYuaGlkZV9jbGllbnRzID0gdHJ1ZVxyXG4gICAgICAgICAgc2VsZi5oaWRlX251bWJlcnMgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgc2VsZWN0cy5tZXNzYWdlVHlwZS5zZWxlY3QyKCd2YWwnLCdtb3JhJyk7XHJcblxyXG4gICAgICBzZWxlY3RzLmNsaWVudHMub24oJ3NlbGVjdDI6c2VsZWN0JywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB2YXIgY2xpZW50ZXMgPSBzZWxlY3RzLmNsaWVudHMuc2VsZWN0MignZGF0YScpXHJcbiAgICAgICAgdmFyIGl0ZW1zID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbGllbnRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICdub21icmVfY29tcGxldG8nOiBjbGllbnRlc1tpXS50ZXh0LFxyXG4gICAgICAgICAgICAnY2VsdWxhcic6IGNsaWVudGVzW2ldLmlkXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLm1lc3NhZ2VfZGF0YS5jbGllbnRlcyA9IGl0ZW1zXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG59KSIsInZhciBSZXRpcmVtZW50UmVwb3J0ID0gbmV3IFZ1ZSh7XHJcbiAgZWw6ICcjcmV0aXJvcycsXHJcbiAgZGF0YToge1xyXG4gICB0YWJsZTogJycsXHJcbiAgIHRhYmxlSFRNTDogJycsXHJcbiAgIGJldHdlZW46IHtcclxuICAgICBmaXJzdF9kYXRlOiAnJyxcclxuICAgICBzZWNvbmRfZGF0ZTogJydcclxuICAgfVxyXG4gIH0sXHJcbiAgbWV0aG9kczoge1xyXG4gICAgZ2V0UmVwb3J0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBmb3JtID0gJ2RhdGE9JyArIEpTT04uc3RyaW5naWZ5KHRoaXMuYmV0d2VlbilcclxuICAgICAgYXhpb3MucG9zdChCQVNFX1VSTCArICdjb250cmFjdC9nZXRDYW5jZWxhdGlvbnMvJylcclxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcylcclxuICAgICAgfSlcclxuICAgIH0sXHJcblxyXG4gICAgZmlsbFRhYmxlOiBmdW5jdGlvbihkYXRhSFRNTCkge1xyXG4gICAgICBcclxuICAgIH1cclxuICB9XHJcbn0pIl19
