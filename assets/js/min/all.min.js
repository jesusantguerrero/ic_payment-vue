function connectAndSend(t,e,a,n,o,i,c){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){4==r.readyState&&200==r.status?(null!=n?n(r.responseText,a):e&&displayMessage(r.responseText),null!=i&&i()):4!=r.readyState&&c&&c()},r.open("POST",BASE_URL+t,!0),r.setRequestHeader("content-type","application/x-www-form-urlencoded"),r.send(o)}function displayMessage(t){var e,a="rgba(102,187,106,1)";t.includes("SWAL")?(t=t.replace("SWAL",""),swal({title:"Exito!",html:t,type:"success",timer:3e3})):(t.includes(MESSAGE_ERROR)?a="rgba(244,67,54,1)":t.includes(MESSAGE_INFO)&&(a="rgba(2,136,209,1)"),(e=$(".toast")).find("span").html(t).css({background:a}),e.css({display:"flex"}),e.animate({opacity:"1"},500,function(){setTimeout(function(){e.animate({opacity:"0"}),e.css({display:"none"})},2e3)}))}function displayAlert(t,e,a){t||(t="Revise"),e||(e="Asegurate de llenar todos los campos"),a||(a="error"),swal({title:t,text:e,type:a,confirmButtonClass:"btn",buttonsStyling:!1})}function fillCurrentTable(t,e,a){(void 0!=a?$("#"+a+" tbody"):$("[class*='t-'] tbody")).html(t),e&&e()}function fillClientTable(t,e){fillCurrentTable(t,e,"t-clients")}function fillCajaTable(t,e){fillCurrentTable(t,e,"caja"),e&&e()}function fillPaymentsList(t,e){$(".list-nextpayments").html(t)}function fillAveriasList(t,e){$("#averias-list").html(t),e()}function fillInstallationsList(t,e){$("#installations-list").html(t),e()}function makeContracList(t,e){if("nada"!=t){for(var a,n,o,i,c=JSON.parse(t),r="<option value=''>--Selecciona--</option>",l=c.cliente,s=0;s<c.contratos.length;s++)a=c.contratos[s].id_contrato,n=c.contratos[s].servicio,o=c.contratos[s].nombre_equipo,i=c.contratos[s].router,r+="<option value='"+a+"' data-service='"+n+"'  data-equipment='"+o+"'  data-e-mac='"+c.contratos[s].mac_equipo+"'",r+=" data-router='"+i+"'  data-r-mac='"+c.contratos[s].mac_router+"' data-code='"+c.contratos[s].codigo+"'>",r+=a+"</option>";$("#extra-client-contract").html(r),$("#extra-client-name").val(l.nombres+" "+l.apellidos)}else displayMessage(MESSAGE_ERROR+" Este cliente no existe revise su cedula por favor")}function clearTbody(t){$(t).html("")}function fillClientFields(t,e){if("nada"!=t){var a=JSON.parse(t);$("#averias-client-id").val(a.id_cliente),$("#a-client").val(a.nombres+" "+a.apellidos)}else displayMessage(MESSAGE_ERROR+" Este cliente no existe revise su cedula por favor")}function isEmpty(t,e){for(var a=0;a<t.length;a++)if(null==t[a]||""==t[a])return!0;return!1}function getPaginationData(t){var e=$(t+" .per-page").val(),a=$(t+" .max-limit"),n=$(t+" .max-limit-visible"),o=$(t+" .min-limit"),i=$(t+" .total-rows"),c=$(t+" .total-rows").text(),r=Number(o.text()),l=Number(a.text()),s=r,d=l;return c=Number(c),e=Number(e),l+=e,r+=e,{perpage:e,min:s,max:d,previous:r,next:l,$maxLimit:a,$maxLimitVisible:n,$minLimit:o,$totalRows:i,total:c}}function initPagination(t,e,a){var n=getPaginationData(t),o=n.$totalRows;setTimeout(function(){Number(o.text())<=5&&n.$maxLimitVisible.text(Number(o.text()))},2e3),$(t+" .next-page").on("click",function(n){n.stopImmediatePropagation();var o=getPaginationData(t);if(o.max<o.total){var i=o.max+o.perpage;a(o.max,o.perpage,e),i>o.total?o.$maxLimitVisible.text(o.total):o.$maxLimitVisible.text(i),o.$maxLimit.text(o.max+o.perpage),o.$minLimit.text(o.min+o.perpage)}}),$(t+" .previous-page").on("click",function(n){n.stopImmediatePropagation();var o=getPaginationData(t);if(1!=o.min){var i=o.max-o.perpage;o.$maxLimit.text(i),o.$maxLimitVisible.text(i),o.$minLimit.text(o.min-o.perpage),a(o.min-o.perpage-1,o.perpage,e)}}),$(t+" .per-page").on("change",function(n){n.stopImmediatePropagation();var o=getPaginationData(t);o.$maxLimit.text(o.perpage),o.perpage>o.total?o.$maxLimitVisible.text(o.total):o.$maxLimitVisible.text(o.perpage),o.$minLimit.text(o.min),a(o.min,o.perpage,e)})}function updateSaldo(t){t="RD$ "+CurrencyFormat(t),$(".current-saldo").text(t)}function updateCount(t){$(".total-rows").html(t)}function updateCajaCount(t){$("#caja .total-rows").html(t)}function validateModal(t){var e=$(t+" .password"),a=$(t+" .password-confirm"),n=$(t+" .save");a.on("blur",function(){validateTwo(e,a,n)}),n.on("click",clearForm(t))}function validateTwo(t,e,a){e.val()==t.val()&&""!=e.val()?(replaceClass(t.parent(),"has-error","has-success"),replaceClass(e.parent(),"has-error","has-success"),a.removeAttr("disabled","")):(replaceClass(t.parent(),"has-success","has-error"),replaceClass(e.parent(),"has-success","has-error"),a.attr("disabled",""))}function clearForm(t){$(t+" input").val("")}function replaceClass(t,e,a){t.addClass(a),t.removeClass(e)}function deleteValidation(t,e){var a;t.on("keyup",function(t){t.stopImmediatePropagation(),a=$(this).val();var n=$("tr.selected").find(".th-client").text().trim();console.log("texto:"+a+" = "+n),a==n?e.removeAttr("disabled"):e.attr("disabled","")})}function getNow(){var t,e,a,n;return n=new Date,t=n.getFullYear(),e=n.getMonth(),a=n.getDate(),t+"-"+e+"-"+a}function makeRowsClickable(){$("tbody tr").on("click",function(t){t.stopImmediatePropagation();var e,a,n,o,i;i=$("#get-details"),o=$("#client-new-contract"),n=$("#go-new-contract"),(e=$(this)).hasClass("selected")?($("tbody tr").removeClass("selected"),i.attr("href",""),o.attr("href",""),n.attr("href","")):($("tbody tr").removeClass("selected"),e.toggleClass("selected"),a=e.find(".id_cliente").text().trim(),i&&i.attr("href",BASE_URL+"process/details/"+a),o&&o.attr("href",BASE_URL+"process/newcontract/"+a),n&&("ir a pagos"==n.text().toLowerCase()?n.attr("href",BASE_URL+"process/details/"+a+"/pagos"):n.attr("href",BASE_URL+"process/newcontract/"+a)),contractRows(e))})}function contractRows(t){var e;t.find(".id_contrato").text().trim(),e=t.find(".th-client").attr("data-id-cliente"),$("#btn-pay-view").attr("href",BASE_URL+"process/details/"+e+"/pagos"),$("#btn-see-in-detail").attr("href",BASE_URL+"process/details/"+e)}function makeServiceCardClickable(){var t=$(".service-card");t.on("click",function(e){e.stopImmediatePropagation();var a=$(this),n=a.attr("data-payment");t.removeClass("selected"),a.addClass("selected"),$("#contract-client-payment").val(n)})}function verifyPaymentStatus(){$(".td-estado").each(function(t,e){var a=$(this),n=a.text().trim();"no pagado"==n?a.css({color:"rgba(200,0,0,.7)"}):"pagado"==n&&a.parents("tr").css({background:"rgba(22,255,0,.3)",color:"#999"})})}function verifyContractStatus(){$(".td-estado").each(function(t,e){var a=$(this),n=a.text().trim();"activo"==n?a.css({color:"green"}):"saldado"==n&&a.parents("tr").css({background:"rgba(22,255,0,.3)",color:"#999"})})}function verifyClientStatus(){$("td").each(function(t,e){var a=$(this),n=a.text().trim();"no activo"==n?a.css({color:"rgba(200,0,0,.7)"}):"activo"==n&&a.css({color:"green"})})}function newContractFunctions(){function t(t){o.removeAttr("checked","").html(""),n.attr("checked","").html("&#10004;"),a.removeClass("print-requirement"),i.removeClass("hide"),c.addClass("hide")}function e(t){n.removeAttr("checked","").html(""),o.attr("checked","").html("&#10004;"),a.addClass("print-requirement"),c.removeClass("hide"),i.addClass("hide")}$("#btn-print-contract");var a=$(".note-item"),n=$("#radio-new-contract"),o=$("#radio-just-requirement"),i=$(".contract-controls"),c=$(".requirement-controls");n.parents("label").on("click",function(){t()}),o.parents("label").on("click",function(){e()})}function detailsFunctions(){$('[role="tab"]').on("click",function(){"#payments"==$(this).attr("href")?$(".payment-controls").addClass("visible"):$(".payment-controls").removeClass("visible"),getTabControls($(this))})}function getTabControls(t){var e=t.attr("aria-controls");$(".dynamic-controls").text(e)}function notificationFunctions(){var t=$("#btn-see-averias"),e=$("#btn-see-pagos"),a=($("#btn-see-caja"),$("#btn-see-deudores")),n=$("#btn-see-day-incomes"),o=$(".layout-container");t.on("click",function(){o.animate({left:"-100%"},200)}),e.on("click",function(){o.animate({left:"0"},200)}),a.on("click",function(){o.animate({left:"-200%"},200)}),n.on("click",function(){o.animate({left:"-300%"},200)})}function getContracts(t){connectAndSend("process/data_for_extra",!1,null,makeContracList,"dni="+t,null)}var BASE_URL="http://localhost/ic/",MESSAGE_SUCCESS='<i class="material-icons">done_all</i>',MESSAGE_ERROR='<i class="material-icons">error_outline</i>',MESSAGE_INFO='<i class="material-icons">info_outline</i>',SUMMER_SKY="#1FA1D0";$(function(){$('[data-toggle="tooltip"]').tooltip()}),$(function(){!function(){function t(){e=new Date,sDate=e.toString(),n.text(e.getDate()),o.text("De "+l[e.getMonth()]+" de "+e.getFullYear()),i.text(r[e.getDay()]),a=moment().format("LTS"),c.html(a)}var e,a,n=$(".day"),o=$(".month-year"),i=$(".dayweek"),c=$(".hour span"),r=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],l=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];setInterval(t,1e3)}(),function(){$("#company-section").animate({left:"0"},200),$(".administrador .aside-buttons a").on("click",function(t){t.preventDefault();var e=$(this).attr("href").slice(1);null!=e&&($(".company-details").animate({left:"-110%"},200),$("#"+e+".company-details").animate({left:"0"},200))}),$("#acount-section").length>0&&$("#acount-section").animate({left:"0"},200)}(),function(){var t=$(".user-info-tip");$(".profile-picture"),$(".btn-more").on("click",function(e){t.toggleClass("visible")})}(),function(){validateModal("#new-user-modal"),validateModal("#update-user-modal")}(),makeServiceCardClickable(),detailsFunctions(),notificationFunctions(),newContractFunctions()}),$("#search-client-modal").on("show.bs.modal",function(t){var e=$(t.relatedTarget).find(".section-title").text();e||(e="Buscar Cliente"),"registrar pago"==e.toLowerCase().trim()?buttonText="ir a Pagos":buttonText="Nuevo Contrato";var a=$(this);a.find(".modal-title").text(e),a.find(".modal-footer .save").text(buttonText)}),$("#select-extra-service").on("change",function(){var t=$("#select-extra-service :selected"),e=t.attr("data-payment");console.log(t),console.log(e),$("#extra-service-cost").val(e)}),$("#extra-client-contract").on("change",function(){var t=$("#extra-client-contract :selected");$("#extra-contract-service").val(t.attr("data-service")),$("#extra-equipo").val(t.attr("data-equipment")),$("#extra-router").val(t.attr("data-router")),$("#extra-e-mac").val(t.attr("data-e-mac")),$("#extra-r-mac").val(t.attr("data-r-mac")),$("#extra-code").val(t.attr("data-code"))}),$(".columns-right").removeClass("pull-right"),$("#select-contract-code").on("change",function(){var t=$("#select-contract-code :selected");$("#contract-ip").val(t.attr("data-ip-final")),$("#u-contract-ip").val(t.attr("data-ip-final"))}),$(function(){function t(){"notificaciones"==Q&&(u("averias"),$("#averias-view-mode").on("change",function(t){t.stopImmediatePropagation(),B()}),$("#installations-view-mode").on("change",function(t){t.stopImmediatePropagation(),N()})),"contratos"==Q&&i(),$("#btn-save-averia").on("click",function(t){t.stopImmediatePropagation(),q()}),$("#a-client-dni").on("keydown",function(t){var e=t.which,a=$(this).val();13==e&&f(a,fillClientFields)}),$(".btn-update-averia").on("click",function(t){t.stopImmediatePropagation();var e=$(this).parents(".averia-item").find(".code");F(e=e.text().trim())}),$(".btn-update-installation").on("click",function(t){t.stopImmediatePropagation();var e=$(this).parents(".averia-item").find(".code");Y(e=e.text().trim())}),$("#extra-controls").on("click",function(t){t.stopImmediatePropagation(),z($(this))}),$("#extra-client-dni").on("keydown",function(t){var e=t.which,a=$(this).val();13==e&&getContracts(a)})}function e(){initPagination("#t-users","users",y),$("#btn-save-user").on("click",function(t){t.stopImmediatePropagation(),r()}),$("#btn-update-user").on("click",function(t){t.stopImmediatePropagation(),l()}),$(".delete-user").on("click",function(t){t.preventDefault();var e=$(this).parents("tr"),a=e.find(".user-id").text().trim();swal({title:"Está Seguro?",text:"Desea Eliminar al Usuario "+e.find("td:nth(3)").text()+"?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",confirmButtonBackground:SUMMER_SKY}).then(function(){d(a)})}),$(".edit-user").on("click",function(t){t.preventDefault();var e=$(this).parents("tr").find("td");$("#e-nickname").val(e.eq(2).text()),$("#e-name").val(e.eq(3).text()),$("#e-lastname").val(e.eq(4).text()),$("#e-dni").val(e.eq(5).text()),$("#update-user-modal").modal()}),$("#update-company-data").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation(),X()}),$("#btn-save-averia").on("click",function(t){t.stopImmediatePropagation(),q()})}function a(){"administrador"==Q&&(initPagination("#caja","caja",y),u("caja"));var t=$("#btn-add-money"),e=$("#btn-retire-money"),a=$("#caja-user"),n=$("#caja-date");t.on("click",function(t){t.stopImmediatePropagation(),U()}),e.on("click",function(t){t.stopImmediatePropagation(),O()}),n.on("change",function(t){t.stopImmediatePropagation(),J()}),a.on("change",function(t){t.stopImmediatePropagation(),J()})}function n(){"clientes"==Q&&(u("clientes"),initPagination("#t-clients","clientes",y)),makeRowsClickable(),verifyClientStatus(),$("#btn-save-client").on("click",function(t){t.stopImmediatePropagation(),p()}),$("#update-client").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$("tr.selected");e&&f(e.find(".id_cliente").text().trim(),g)}),$("#client-searcher").on("keyup",function(t){t.stopImmediatePropagation(),x($(this).val(),"clientes",fillCurrentTable)}),$("#client-searcher-newcontract").on("keyup",function(t){t.stopImmediatePropagation();var e=$(this).val();isEmpty([e])?clearTbody(".lobby-results"):x(e,"clientes",fillClientTable)}),$("#delete-client").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$("tr.selected");if(e.length>0){var a=e.find(".id_cliente").text().trim();swal({title:"Está Seguro?",text:"Desea Eliminar al(la) Cliente "+e.find("td:nth(2)").text()+" "+e.find("td:nth(3)").text()+"?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",confirmButtonBackground:SUMMER_SKY}).then(function(){h(a,"clientes")})}})}function o(){u("servicios"),initPagination("#t-services","servicios",y),makeRowsClickable(),$("#btn-save-service").on("click",function(t){t.stopImmediatePropagation(),S()}),$("#delete-service").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$("tr.selected");if(e.length>0){var a=e.find(".id_servicio").text().trim();swal({title:"Está Seguro?",text:"Desea Eliminar  Este Servicio?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",confirmButtonBackground:SUMMER_SKY}).then(function(){h(a,"servicios")})}}),$("#edit-service").on("click",function(t){t.preventDefault();var e=$("tr.selected").find("td");$("#update-service-modal input");$("#u-service-id").val(e.eq(1).text()),$("#u-service-name").val(e.eq(2).text()),$("#u-service-description").val(e.eq(3).text()),$("#u-service-monthly-payment").val(Number(e.eq(4).text().slice(3))),$("#u-service-type").val(e.eq(5).text()),$("#update-service-modal").modal()}),$("#btn-update-service").on("click",function(t){t.stopImmediatePropagation(),_()})}function i(){u("contratos"),initPagination("#t-contracts","v_contratos",y),makeRowsClickable(),$("#btn-save-contract").on("click",function(t){t.stopImmediatePropagation(),C()}),$("#btn-add-extra").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation(),E()});$("#contract-searcher").on("keyup",function(t){t.stopImmediatePropagation(),x($(this).val(),"v_contratos",fillCurrentTable,i)}),$("#btn-cancel-contract").on("click",function(t){t.preventDefault();var e=$("tr.selected"),a=e.find("td");if(void 0!=e){$(".cancel-name").text(a.eq(2).text());var n=$(".confirmed-data"),o=$("#cancel-permanently");deleteValidation(n,o),$("#cancel-contract-modal").modal(),o.on("click",function(){P()}),n.val(""),o.attr("disabled","")}}),$("#btn-update-contract").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$("tr.selected");e&&R(e.find(".id_contrato").text().trim(),I)}),$("#select-contract-sector").on("change",function(t){t.stopImmediatePropagation(),T()})}function c(){Z||(j(),Z=!0),verifyPaymentStatus(),initPagination("#t-pagos","pagos_por_contrato",y),u("pagos_por_contratos"),$("#btn-pay").on("click",function(t){t.stopImmediatePropagation();var e=$("tr.selected");e&&M(e.find(".id_pago").attr("data-id").trim())}),$("#select-contract").on("change",function(t){t.stopImmediatePropagation(),j()}),makeRowsClickable()}function r(){var t,a,n,o,i,c,r;isEmpty([a=$("#user-nickname").val(),n=$("#user-password").val(),o=$("#user-name").val(),i=$("#user-lastname").val(),c=$("#user-dni").val(),r=$("#user-type").val()])?displayAlert("Revise","LLene todos los campos por favor","error"):(t="nickname="+a+"&password="+n+"&name="+o+"&lastname="+i,connectAndSend("user/addnew",!0,e,null,t+="&dni="+c+"&type="+r,s))}function l(){var t,a,n,o,i,c;isEmpty([a=$("#e-nickname").val(),n=$("#e-name").val(),o=$("#e-lastname").val(),i=$("#e-dni").val(),c=$("#e-type").val()])?displayAlert("Revise","LLene todos los campos por favor","error"):(t="nickname="+a+"&name="+n+"&lastname="+o,connectAndSend("user/update",!0,e,null,t+="&dni="+i+"&type="+c,s))}function s(){connectAndSend("user/getusers",!1,e,fillCurrentTable,"table=users",null)}function d(t){connectAndSend("user/deleteuser",!0,e,null,"user_id="+t,s)}function u(t){var e="tabla="+t,a=updateCount;"caja"==t&&(a=updateCajaCount),connectAndSend("process/count",!1,null,a,e,null)}function p(){var t,e,a,o,i,c,r,l,s,d,u,p,m,f;e=$("#client-name").val(),a=$("#client-lastname").val(),o=$("#client-dni").val(),i=$("#client-phone").val(),c=$("#client-provincia").val(),r=$("#client-sector").val(),l=$("#client-street").val(),s=$("#client-house").val(),d=$("#client-telephone").val(),u=$("#client-job").val(),p=$("#client-job-telephone").val(),m=$("#client-salary").val(),f=getNow(),isEmpty([e,a,o,i,c,r,l,s,d])?displayAlert("Revise","LLene todos los campos por favor","error"):(t="nombres="+e+"&apellidos="+a+"&cedula="+o+"&celular="+i,t+="&provincia="+c+"&sector="+r+"&calle="+l+"&casa="+s+"&telefono="+d,t+="&lugar_trabajo="+u+"&tel_trabajo="+p+"&ingresos="+m+"&fecha_registro="+f,connectAndSend("process/add",!0,n,null,t+="&estado=no activo&tabla=clientes",v))}function m(){connectAndSend("process/getall",!1,n,fillCurrentTable,"tabla=clientes",null)}function v(){connectAndSend("process/lastpage",!1,n,fillCurrentTable,"tabla=clientes",null)}function f(t,e){form="tabla=clientes&id="+t,connectAndSend("process/getone",!1,n,e,form,null)}function g(t){function e(){isEmpty([i.val(),c.val(),r.val(),l.val(),s.val(),d.val(),u.val(),p.val(),v.val()])?displayAlert("Revise","LLene todos los campos por favor","error"):(form="id="+o+"&nombres="+i.val()+"&apellidos="+c.val()+"&cedula="+r.val(),form+="&celular="+l.val()+"&provincia="+s.val()+"&sector="+d.val()+"&calle="+u.val(),form+="&casa="+p.val()+"&telefono="+v.val()+"&lugar_trabajo="+f.val()+"&tel_trabajo =",form+="&ingresos="+b.val(),form+=g.val()+"&tabla=clientes",connectAndSend("process/update",!0,n,null,form,m))}var a=JSON.parse(t),o=a.id_cliente,i=$("#u-client-name"),c=$("#u-client-lastname"),r=$("#u-client-dni"),l=$("#u-client-phone"),s=$("#u-client-provincia"),d=$("#u-client-sector"),u=$("#u-client-street"),p=$("#u-client-house"),v=$("#u-client-telephone"),f=$("#u-client-job"),g=$("#u-client-job-telephone"),b=$("#u-client-salary");i.val(a.nombres),c.val(a.apellidos),r.val(a.cedula),l.val(a.celular),s.val(a.provincia),d.val(a.sector),u.val(a.calle),p.val(a.casa),v.val(a.telefono),f.val(a.lugar_trabajo),g.val(a.tel_trabajo),b.val(a.salario),$("#update-client-modal").modal(),$("#btn-update-client").on("click",function(){e()})}function b(t){var e,a,n,o,i,r;a=$("#text-observations").val(),i=$("#input-abono"),n=t?0:i.val(),o=$("#detail-client-id").val(),r=$(".abono-value"),void 0!=t?(i.val(n),$(".abono-box").removeClass("have-abono"),t=1):(i.attr("disabled"),$(".abono-box").addClass("have-abono"),t=0),e="observaciones="+a+"&abonos="+n+"&id_cliente="+o+"&modo="+t,connectAndSend("process/update",!0,c,null,e+="&tabla=observaciones",null),r.find("input").val("RD$ "+CurrencyFormat(n))}function h(t,e){var a,i,c="tabla="+e+"&id="+t;switch(e){case"clientes":a=n,i=m;break;case"servicios":a=o,i=k}connectAndSend("process/delete",!0,a,null,c,i)}function y(t,r,l){var s,d="user/";switch("users"!=l&&(d="process/"),tableFill=fillCurrentTable,l){case"users":s=e;break;case"clientes":s=n;break;case"servicios":s=o;break;case"v_contratos":s=i;break;case"pagos_por_contrato":s=c;break;case"caja":s=a,tableFill=fillCajaTable}var u="table="+l+"&offset="+t+"&perpage="+r;connectAndSend(d+"paginate",!1,s,tableFill,u,null)}function x(t,e,a,o){void 0==o&&(o=n),void 0==a&&(a=fillCurrentTable);var i=t;null==i&&""==i||connectAndSend("process/search",!1,o,a,"tabla="+e+"&word="+i,null)}function S(){var t,e,a,n,i;isEmpty([e=$("#service-name").val(),a=$("#service-description").val(),n=$("#service-monthly-payment").val(),i=$("#service-type").val()])?displayAlert("Revise","LLene todos los campos por favor","error"):(t="nombre="+e+"&descripcion="+a+"&mensualidad="+n+"&tipo="+i,connectAndSend("process/add",!0,o,null,t+="&tabla=servicios",k))}function k(){connectAndSend("process/getall",!1,o,fillCurrentTable,"tabla=servicios",null)}function _(){var t,e,a,n,i,c;isEmpty([e=$("#u-service-id").val(),a=$("#u-service-name").val(),n=$("#u-service-description").val(),i=$("#u-service-monthly-payment").val(),c=$("#u-service-type").val()])?displayAlert("Revise","LLene todos los campos por favor","error"):(t="id_servicio="+e+"&nombre="+a+"&descripcion="+n+"&mensualidad="+i,connectAndSend("process/update",!0,o,null,t+="&tipo="+c+"&tabla=servicios",k))}function C(){var t,e,a,n,o,i,c,r,l,s,d,u,p,m,v;e=$("#contract-client-id").val(),a=$("#contract-user-id").val(),n=$(".service-card.selected").attr("data-id"),i=$("#contract-client-date").val(),r=$("#contract-client-months").val(),l=$("#contract-equipment").val(),s=$("#contract-e-mac").val(),d=$("#contract-router").val(),u=$("#contract-r-mac").val(),m=$("#contract-equipment-model").val(),v=$("#contract-ip").val(),o=$("#select-contract-code").val(),c=$("#contract-client-payment").val(),p=moment(i).add(1,"months").format("YYYY-MM-DD"),isEmpty([e,a,n,i,r])?displayAlert("Revise","LLene todos los campos por favor","error"):(t="id_empleado="+a+"&id_cliente="+e+"&id_servicio="+n+"&codigo="+o+"&fecha="+i,t+="&duracion="+r+"&monto_total="+(Number(r)+1)*Number(c)+"&monto_pagado=0&ultimo_pago=null",t+="&mensualidad="+c+"&proximo_pago="+p+"&estado=activo&tabla=contratos",t+="&nombre_equipo="+l+"&mac_equipo="+s+"&router="+d+"&mac_router="+u,connectAndSend("process/add",!0,null,null,t+="&modelo="+m+"&ip="+v,L))}function A(t){connectAndSend("process/extend",!0,i,null,"id_contrato="+idContrator,null)}function w(){connectAndSend("process/lastpage",!1,i,fillCurrentTable,"tabla=contratos",null)}function L(t){$("#btn-save-contract").attr("disabled",""),$("#btn-print-contract").removeAttr("disabled")}function E(){var t=$("tr.selected");if(void 0!=t){var e=t.find("td.th-client").attr("data-cedula");$("#extra-client-dni").val(e),getContracts(e),$("#add-extra-modal").modal()}else displayAlert("Revise","Seleccione el conrato primero","error")}function P(){var t=$("tr.selected"),e=t.find(".id_contrato").text().trim(),a=t.find(".th-client").attr("data-id-cliente");connectAndSend("process/cancel",!0,null,null,"id_contrato="+e+"&fecha="+moment().format("YYYY-MM-DD")+"&id_cliente="+a,w)}function R(t,e){form="tabla=contratos&id_contrato="+t,connectAndSend("process/getone",!1,i,e,form,null)}function I(t){function e(){var t=$("#check-change-ip:checked").length;form="id_contrato="+n+"&nombre_equipo="+o.val()+"&mac_equipo="+c.val(),form+="&router="+r.val()+"&mac_router="+l.val(),form+="&modelo="+s.val(),form+="&tabla=contratos",t>0&&(form+="&ip="+p.val()+"&codigo="+d.val()),connectAndSend("process/update",!0,i,null,form,w)}var a=JSON.parse(t),n=a.id_contrato,o=$("#u-contract-equipment"),c=$("#u-contract-e-mac"),r=$("#u-contract-router"),l=$("#u-contract-r-mac"),s=$("#u-contract-modelo"),d=$("#select-contract-code"),u=$("#check-change-ip"),p=$("#u-contract-ip");o.val(a.nombre_equipo),c.val(a.mac_equipo),r.val(a.router),l.val(a.mac_router),s.val(a.modelo),p.val(a.ip),u.on("click",function(){console.log(u.val())}),$("#update-contract-modal").modal(),$("#update-contract").on("click",function(t){t.stopImmediatePropagation(),e()})}function T(){function t(t){$("#select-contract-code").html(t)}connectAndSend("process/getall",!1,null,t,"id_seccion="+$("#select-contract-sector").val()+"&tabla=ip_list",null)}function j(){var t=$("#select-contract").val();null!=t&&connectAndSend("process/getall",!1,c,fillCurrentTable,"tabla=pagos&id="+t,null)}function D(){connectAndSend("process/lastpage",!1,c,fillCurrentTable,"tabla=pagos",null)}function M(t){if(0==$("#input-abono").val()){connectAndSend("process/update",!0,c,null,"tabla=pagos&id="+t+"&estado=pagado&fecha_pago="+moment().format("YYYY-MM-DD")+"&id_contrato="+$("#select-contract").val(),D)}else displayAlert("Favor Leer","has click en la zona roja de abono para confirmar que le viste antes de registrar el pago","info")}function q(){var e,a;isEmpty([e=$("#averias-client-id").val(),a=$("#a-description").val()])?displayAlert("Revise","LLene todos los campos por favor","error"):connectAndSend("process/add",!0,t,null,"id_cliente="+e+"&descripcion="+a+"&tabla=averias",B),$("#new-averia-modal").find("input,textarea").val("")}function B(){var e=$("#averias-view-mode").val();$(".presentado").text(e),connectAndSend("process/getall",!1,t,fillAveriasList,"tabla=averias&estado="+e,null)}function F(e){connectAndSend("process/update",!0,t,null,"tabla=averias&id_averia="+e,B)}function N(){connectAndSend("process/getall",!1,t,fillInstallationsList,"tabla=instalaciones&estado="+$("#installations-view-mode").val(),null)}function Y(e){connectAndSend("process/update",!0,t,null,"tabla=instalaciones&id_pago="+e,N)}function U(){var t,e,n;t="entrada="+(e=$("#caja-a-amount").val())+"&descripcion="+(n=$("#caja-a-description").val())+"&tabla=caja",isEmpty([e,n])?displayAlert("Revise","LLene todos los campos por favor","error"):connectAndSend("process/add",!0,a,null,t,V)}function O(){var t,e,n;t="salida="+(e=$("#caja-r-amount").val())+"&descripcion="+(n=$("#caja-r-description").val()),isEmpty([e,n])?displayAlert("Revise","LLene todos los campos por favor","error"):connectAndSend("process/retire",!0,a,null,t,V)}function V(){connectAndSend("process/lastpage",!1,a,fillCajaTable,"tabla=caja",G)}function G(){connectAndSend("process/getone",!1,a,updateSaldo,"tabla=caja",null)}function J(){var t=$("#caja-date"),e=$("#caja-user"),n=t.val()?t.val():"%";connectAndSend("process/search",!1,a,fillCajaTable,"tabla=caja&id_empleado="+(e.val()?e.val():"%")+"&fecha="+n,null)}function z(t){switch(t.text().trim().toLowerCase()){case"mejorar":H();break;case"extender":A();break;case"guardar":K()}}function H(){var e,a,n,o;isEmpty([e=$("#extra-client-contract").val(),n=(a=$(".service-card.selected")).attr("data-id"),o=a.attr("data-payment")])?displayAlert("Revise","asegurate de llenar todos los datos y seleccionar el servicio","info"):connectAndSend("process/upgrade",!0,t,null,"id_contrato="+e+"&id_servicio="+n+"&cuota="+o,w)}function K(){var e,a,n,o,i,c,r,l;a=$("#extra-client-contract").val(),o=$("#extra-service-cost").val(),n=$("#select-extra-service").val(),i=$("#extra-equipo").val(),c=$("#extra-e-mac").val(),r=$("#extra-router").val(),l=$("#extra-r-mac").val(),isEmpty([a,n,o])?displayAlert("revise","asegurate de llenar todos los datos y seleccionar el servicio","info"):(e="id_contrato="+a+"&costo_servicio="+o+"&nombre_servicio="+n,connectAndSend("process/addextra",!0,t,null,e+="&nombre_equipo="+i+"&mac_equipo="+c+"&router="+r+"&mac_router="+l,w))}function A(){var e,a;e=$("#extra-client-contract").val(),isEmpty([a=$("#extra-extension-months").val(),e])?displayAlert("revise","asegurate de llenar todos los datos y seleccionar el servicio","info"):connectAndSend("process/extend_contract",!0,t,null,"id_contrato="+e+"&duracion="+a,w)}function X(){var t,e=$("#company-name").val(),a=$("#company-statement").val(),n=$("#company-phone1").val(),o=$("#company-direction").val();t="nombre="+e+"&lema="+a+"&descripcion="+$("#company-description").val()+"&direccion=",connectAndSend("process/update",!0,null,null,t+=o+"&telefono1="+n+"&telefonos="+$("#company-phone2").val()+"&tabla=empresa",null)}function W(){var t;t="cargo_mora="+$("#settings-mora").val()+"&fecha_corte="+$("#settings-fecha-corte").val()+"&apertura_caja="+$("#settings-apertura-caja").val(),t+="&penalizacion_cancelacion="+$("#settings-penalizacion-cancelacion").val()+"&meses_por_defecto="+$("#settings-meses-por-defecto").val(),connectAndSend("process/update",!0,null,null,t+="&split_day="+$("#settings-split-day").val()+"&tabla=settings",null)}var Q=$("title").text().split(" "),Z=!1;switch(Q=Q[4].toLowerCase().trim()){case"home":n();break;case"administrador":e();break;case"clientes":n();break;case"servicios":o();break;case"nuevo_contrato":i(),T();break;case"detalles":c(),function(){$("#btn-save-observations").on("click",function(t){t.stopImmediatePropagation(),b()}),$(".abono-value").on("click",function(t){t.stopImmediatePropagation(),b(!0)})}(),verifyContractStatus();break;case"contratos":i(),n(),verifyContractStatus()}a(),t(),$("#btn-update-settings").on("click",function(t){t.preventDefault(),W()})}),$(function(){function t(){var t=$("#user-input").val(),n=$("#password-input").val();isEmpty([t,n])?swal({title:"Complete los datos",text:"LLene todos los campos indicados para ingresar",type:"error"}):connectAndSend("app/login",!1,!1,a,"user="+t+"&password="+n,null,e)}function e(){$(".loader").css({display:"block"})}function a(t){1==t?window.location.href=BASE_URL+"app/admin/":($(".loader").css({display:"none"}),swal({title:"Credenciales Incorrectas",text:"Revise los datos ingresados e intente de nuevo",type:"error",confirmButtonClass:"btn",buttonsStyling:!1}))}function n(e){key=e.which,console.log("hola"),13==key&&t()}function o(){function t(t){var e,a=t[0],n=t[1],o=t[2];return e="nombre="+a+"&codigo_area="+n+"&registros_posibles="+o,e+="&tabla=secciones",new Promise(function(t){if(connectAndSend("process/add",!0,!1,null,e,null,r))return t()})}swal.setDefaults({input:"text",confirmButtonText:"Next &rarr;",showCancelButton:!0,animation:!1,progressSteps:["1","2","3"]});var e=[{title:"Nombre del sector"},"Codigo del Sector","cuantas Ip's tendremos disponibles?"];swal.queue(e).then(function(e){swal.resetDefaults(),t(e)})}function i(){var t=$("#select-sector").val();null!=t&&connectAndSend("process/getall",!1,null,c,"tabla=ips&id="+t,null)}function c(t){var e=$("#t-sections");e.bootstrapTable("destroy"),$("#t-sections tbody").html(t),e.bootstrapTable()}function r(){function t(t){$("#select-sector").html(t)}connectAndSend("process/getall",!1,null,t,"tabla=secciones",null)}var l=!1;!function(){$("#send-credentials").on("click",function(e){e.stopImmediatePropagation(),t()}),$("#user-input").on("keydown",function(t){t.stopImmediatePropagation(),n(t)}),$("#password-input").on("keydown",function(t){t.stopImmediatePropagation(),n(t)})}(),function(){l||(i(),l=!0),$("#btn-add-section").on("click",function(t){t.stopImmediatePropagation(),o()}),$("#select-sector").on("change",function(t){t.stopImmediatePropagation(),i()})}(),$("a[href]").on("click",function(){e();var t=$(this);try{t.attr("target");setTimeout(function(){$(".loader").css({display:"none"})},3e3)}catch(t){}})});