function initComponents(){switch(currentPage){case"home":initClientHandlers();break;case"administrador":initAdminHandlers();break;case"clientes":initClientHandlers();break;case"servicios":initServicesHandlers();break;case"nuevo_contrato":initContractHandlers(),Contracts.getIpList();break;case"detalles":initPaymentsHandlers(),detailHandlers(),initContractHandlers();break;case"contratos":initContractHandlers(),initClientHandlers();break;case"cuenta":acountHandlers();break;case"secciones":case"secciones2":sectionHandlers()}initCajaHandlers(),initGlobalHandlers()}function initGlobalHandlers(){$("#a-client-dni");"notificaciones"==currentPage&&(Generals.count_table("averias"),$("#averias-view-mode").on("change",function(e){e.stopImmediatePropagation(),Damages.getAll()}),$("#installations-view-mode").on("change",function(e){e.stopImmediatePropagation(),Installations.getAll()}),$("tbody").css({display:"table-row-group"})),"contratos"==currentPage&&initContractHandlers();var e=$("#a-client").select2({dropdownParent:$("#new-averia-modal"),width:"100%",ajax:{url:BASE_URL+"process/search",dataType:"json",delay:250,data:function(e){return{q:e.term,tabla:"clientes_para_averias"}},processResults:function(e,t){return t.page=t.page||1,{results:e.items,pagination:{more:30*t.page<e.total_count}}},cache:!0}});$("#btn-save-averia").on("click",function(t){t.stopImmediatePropagation(),Damages.add(e.val())}),$(".btn-update-averia").on("click",function(e){e.stopImmediatePropagation();var t=$(this).parents(".averia-item").find(".code");t=t.text().trim(),Damages.update(t)}),$(".btn-update-installation").on("click",function(e){e.stopImmediatePropagation();var t=$(this).parents(".averia-item").find(".code");t=t.text().trim(),Installations.update(t)}),$("#extra-controls").on("click",function(e){e.stopImmediatePropagation(),Contracts.btnExtraPressed($(this))}),$("#extra-client-dni").on("keydown",function(e){var t=e.which,a=$(this).val();13==t&&Contracts.getAllOfClient(a)})}function initAdminHandlers(){userTable.init(),$("#btn-save-user").on("click",function(e){e.stopImmediatePropagation(),Users.add()}),$("#btn-update-user").on("click",function(e){e.stopImmediatePropagation(),Users.update()}),$(".delete-user").on("click",function(e){e.preventDefault();var t=$(this).parents("tr").find(".user-id").text().trim(),a=userTable.getRow(t);swal({title:"Está Seguro?",text:"Desea Eliminar al Usuario "+a.nombres+" "+a.apellidos+"?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",cancelButtonText:"Cancelar"}).then(function(){Users.delete(t)})}),$(".edit-user").on("click",function(e){e.preventDefault();var t=$(this).attr("data-user-id"),a=userTable.getRow(t);$("#e-nickname").val(a.nick),$("#e-name").val(a.nombres),$("#e-lastname").val(a.apellidos),$("#e-dni").val(a.cedula),$("#e-type").val(a.tipo_codigo),$("#update-user-modal").modal()}),$("#update-company-data").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation(),Company.update()}),$("#btn-update-settings").on("click",function(e){e.preventDefault(),Settings.update()})}function initCajaHandlers(){"administrador"==currentPage&&cajaTable.init();var e=$("#btn-add-money"),t=$("#btn-retire-money"),a=$("#caja-user"),n=$("#caja-date");e.on("click",function(e){e.stopImmediatePropagation(),Caja.add()}),t.on("click",function(e){e.stopImmediatePropagation(),Caja.retire()}),n.on("change",function(e){e.stopImmediatePropagation(),Caja.search()}),a.on("change",function(e){e.stopImmediatePropagation(),Caja.search()})}function initClientHandlers(){"clientes"==currentPage&&clientTable.init(),$("#btn-save-client").on("click",function(e){e.stopImmediatePropagation(),Clients.add()}),$("#update-client").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=clientTable.getId();t&&Clients.getOne(t,Clients.receiveForEdit)}),$("#client-searcher").on("keyup",function(e){e.stopImmediatePropagation();var t=$(this).val();Generals.search(t,"clientes",clientTable.refresh)}),$("#client-searcher-newcontract").on("keyup",function(e){e.stopImmediatePropagation();var t=$(this).val();isEmpty([t])?clearTbody(".lobby-results"):Generals.search(t,"clientes",clientTable.refresh)}),$("#delete-client").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=clientTable.getSelectedRow();t&&swal({title:"Está Seguro?",text:"Desea Eliminar al(la) Cliente "+t.nombres+" "+t.apellidos+"?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",cancelButtonText:"Cancelar"}).then(function(){Generals.deleteRow(t.id,"clientes")})})}function initServicesHandlers(){serviceTable.init(),$("#btn-save-service").on("click",function(e){e.stopImmediatePropagation(),Services.add()}),$("#delete-service").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=serviceTable.getId();t&&swal({title:"Está Seguro?",text:"Desea Eliminar  el Servicio?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro!",cancelButtonText:"Cancelar"}).then(function(){Generals.deleteRow(t,"servicios")})}),$("#edit-service").on("click",function(e){e.preventDefault();var t=serviceTable.getSelectedRow();$("#u-service-id").val(t.id),$("#u-service-name").val(t.nombre),$("#u-service-description").val(t.descripcion),$("#u-service-monthly-payment").val(Number(t.mensualidad.replace("RD$ ",""))),$("#u-service-type").val(t.tipo),$("#update-service-modal").modal()}),$("#btn-update-service").on("click",function(e){e.stopImmediatePropagation(),Services.update()}),$("#service-searcher").on("keyup",function(e){e.stopImmediatePropagation();var t=$(this).val();Generals.search(t,"servicios",serviceTable.refresh,initServicesHandlers)})}function initContractHandlers(){"contratos"==currentPage&&(contractTable.init(),Contracts.getAll()),$("#btn-save-contract").on("click",function(e){e.stopImmediatePropagation(),Contracts.add()}),$("#btn-add-extra").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation(),Contracts.callExtra()}),$("#contract-searcher").on("keyup",function(e){e.stopImmediatePropagation();var t=$(this).val();Generals.search(t,"v_contratos",contractTable.refresh,null)}),$("#btn-cancel-contract, #btn-detail-cancel-contract").on("click",function(e){e.preventDefault();var t,a;if(console.log("hello world"),"contratos"==currentPage?(t=contractTable.getSelectedRow(),a=Contracts.getAll):((t=detailsContractTable.getSelectedRow()).id=t.id_contrato,t.id_cliente=$("#datail-client-id").val(),t.cliente=$("#detail-client-name").val(),a=Payments.contractRefresh),t){$(".cancel-name").text(t.cliente);var n=$(".confirmed-data"),o=$("#cancel-permanently");deleteValidation(n,t.cliente,o),$("#cancel-print").attr("href",BASE_URL+"process/getcancelcontract/"+t.id),$("#cancel-contract-modal").modal(),o.on("click",function(e){e.stopImmediatePropagation(),console.log(t),Contracts.cancel(t,a),o.attr("disable")}),n.val(""),$("#cancel-contract-modal .alert").removeClass("hide"),o.attr("disabled","")}else swal("Debes seleccionar un contrato")}),$("#btn-suspend-contract").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=contractTable.getSelectedRow();t?swal({title:"Está Seguro?",text:"Desea Suspender el contrato de "+t.cliente+" ?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro",cancelButtonText:"Cancelar"}).then(function(){Contracts.suspend(t.id)}):swal("Debe seleccionar un contrato")}),$("#btn-update-contract").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=contractTable.getId();t&&Contracts.getOne(t,Contracts.recieve)}),$("#select-contract-sector").on("change",function(e){e.stopImmediatePropagation(),Contracts.getIpList()}),$("#select-pay-until").on("change",function(e){e.stopImmediatePropagation();var t=$("#select-pay-until :selected").attr("data-contract"),a=$(this).val();Payments.updateUntil(t,a)})}function initPaymentsHandlers(){function e(e){var t=$(".payment-mode.selected").text(),a={id:e.toString(),module:"pagos"},n="data="+JSON.stringify({tipo:t})+"&extra_info="+JSON.stringify(a),o=axios.post(BASE_URL+"process/axiosupdate",n);o.then(function(e){}),o.catch(function(){console.log(error)})}paymentTable.init(),extraTable.init(),ran||(Payments.getAll(),ran=!0),$("#btn-pay").on("click",function(t){t.stopImmediatePropagation();var a=paymentTable.getId();a&&(Payments.update(a),e(a))}),$("#select-contract").on("change",function(e){e.stopImmediatePropagation(),Payments.getAll()}),$("#payment-detail-box").collapse()}function detailHandlers(){var e=$("#detail-client-name");$("#btn-save-observations").on("click",function(e){e.stopImmediatePropagation(),Payments.saveAbonos()}),$("#btn-save-real-observations").on("click",function(e){e.stopImmediatePropagation(),Clients.saveObservations()}),detailsContractTable.init(),$("#btn-detail-suspend-contract").on("click",function(t){t.preventDefault(),t.stopImmediatePropagation();var a=detailsContractTable.getSelectedRow();a?swal({title:"Está Seguro?",text:"Desea Suspender el contrato de "+e.val()+" ?",type:"warning",showCancelButton:!0,confirmButtonText:"Estoy Seguro",cancelButtonText:"Cancelar"}).then(function(){Contracts.suspend(a.id_contrato,Payments.contractRefresh)}):swal("Debe seleccionar un contrato")}),$("#btn-call-reconnect").on("click",function(e){e.stopImmediatePropagation(),detailsContractTable.getSelectedRow()?$("#reconnect-modal").modal():swal("Debe seleccionar un contrato primero")}),$("#btn-reconnect").on("click",function(e){e.stopImmediatePropagation();var t=detailsContractTable.getSelectedRow();t&&Contracts.reconnect(t.id_contrato,Payments.contractRefresh)}),$("#btn-call-extra").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation();Contracts.callExtra("details")})}function acountHandlers(){var e=$("#acount-user-id"),t=$("#acount-current-password"),a=$("#update-user-data"),n=$("#acount-new-password");$("#acount-current-password").on("keyup",function(a){a.stopImmediatePropagation(),Users.confirmPassword(e.val(),t.val())}),a.on("click",function(a){a.preventDefault(),a.stopImmediatePropagation(),Users.updatePassword(e.val(),t.val(),n.val())})}function sectionHandlers(){ran||(sectionTable.init(),Sections.getIps(),ran=!0),$("#btn-add-section").on("click",function(e){e.stopImmediatePropagation(),Sections.add()}),$("#select-sector").on("change",function(e){e.stopImmediatePropagation(),Sections.getIps()})}var currentPage=$("title").text().split(" ");currentPage=currentPage[4].toLowerCase().trim();var ran=!1;$(function(){initComponents()});