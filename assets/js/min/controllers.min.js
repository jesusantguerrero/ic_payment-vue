var Users={add:function(){var e,a,n,t,l,o,r;a=$("#user-nickname").val(),n=$("#user-password").val(),t=$("#user-name").val(),l=$("#user-lastname").val(),o=$("#user-dni").val(),r=$("#user-type").val(),isEmpty([a,n,t,l,o,r])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="nickname="+a+"&password="+n+"&name="+t+"&lastname="+l,e+="&dni="+o+"&type="+r,connectAndSend("user/addnew",!0,initAdminHandlers,null,e,Users.getAll))},update:function(){var e,a,n,t,l,o;a=$("#e-nickname").val(),n=$("#e-name").val(),t=$("#e-lastname").val(),l=$("#e-dni").val(),o=$("#e-type").val(),isEmpty([a,n,t,l,o])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="nickname="+a+"&name="+n+"&lastname="+t,e+="&dni="+l+"&type="+o,connectAndSend("user/update",!0,initAdminHandlers,null,e,Users.getAll))},getAll:function(){connectAndSend("user/getusers",!1,initAdminHandlers,fillCurrentTable,"table=users",null)},delete:function(e){var a="user_id="+e;connectAndSend("user/deleteuser",!0,initAdminHandlers,null,a,Users.getAll)},confirmPassword:function(e,a){function n(e){var a=$("#acount-new-password"),n=$("#acount-confirm-new-password");1==e?(a.removeAttr("disabled"),n.removeAttr("disabled"),validateThis()):(a.attr("disabled",!0),n.attr("disabled",!0))}var t="user_id="+e+"&current_password="+a;connectAndSend("user/confirm_password",!1,!1,n,t,null,null)},updatePassword:function(e,a,n){var t="user_id="+e+"&current_password="+a+"&new_password="+n;connectAndSend("user/update_password",!1,!1,Users.passwordChanged,t,null,heavyLoad)},passwordChanged:function(e){1==e?(displayMessage(MESSAGE_SUCCESS+"Contraseña Cambiada con exito"),setTimeout(function(){window.location.href=BASE_URL+"app/logout"},3e3)):displayMessage(MESSAGE_ERROR+" Error al cambiar de contraseña, revise la contraseña actual")}},Clients={add:function(){var e,a,n,t,l,o,r,c,s,i,d,u,v,p;a=$("#client-name").val(),n=$("#client-lastname").val(),t=$("#client-dni").val(),l=$("#client-phone").val(),o=$("#client-provincia").val(),r=$("#client-sector").val(),c=$("#client-street").val(),s=$("#client-house").val(),i=$("#client-telephone").val(),d=$("#client-job").val(),u=$("#client-job-telephone").val(),v=$("#client-salary").val(),p=moment().format("YYYY-MM-DD"),isEmpty([a,n,t,l,o,r,c,s,i])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="nombres="+a+"&apellidos="+n+"&cedula="+t+"&celular="+l,e+="&provincia="+o+"&sector="+r+"&calle="+c+"&casa="+s+"&telefono="+i,e+="&lugar_trabajo="+d+"&tel_trabajo="+u+"&ingresos="+v+"&fecha_registro="+p,e+="&estado=no activo&tabla=clientes",connectAndSend("process/add",!0,initClientHandlers,null,e,Clients.getLastPage))},getAll:function(){connectAndSend("process/getall",!1,initClientHandlers,fillCurrentTable,"tabla=clientes",null)},getLastPage:function(){connectAndSend("process/lastpage",!1,initClientHandlers,fillCurrentTable,"tabla=clientes",null)},getOne:function(e,a){form="tabla=clientes&id="+e,connectAndSend("process/getone",!1,initClientHandlers,a,form,null)},receiveForEdit:function(e){function a(){isEmpty([l.val(),o.val(),r.val(),c.val(),s.val(),i.val(),d.val(),u.val(),v.val()])?displayAlert("Revise","LLene todos los campos por favor","error"):(form="id="+t+"&nombres="+l.val()+"&apellidos="+o.val()+"&cedula="+r.val(),form+="&celular="+c.val()+"&provincia="+s.val()+"&sector="+i.val()+"&calle="+d.val(),form+="&casa="+u.val()+"&telefono="+v.val()+"&lugar_trabajo="+p.val()+"&tel_trabajo =",form+="&ingresos="+f.val(),form+=m.val()+"&tabla=clientes",connectAndSend("process/update",!0,initClientHandlers,null,form,Clients.getLastPage))}var n=JSON.parse(e),t=n.id_cliente,l=$("#u-client-name"),o=$("#u-client-lastname"),r=$("#u-client-dni"),c=$("#u-client-phone"),s=$("#u-client-provincia"),i=$("#u-client-sector"),d=$("#u-client-street"),u=$("#u-client-house"),v=$("#u-client-telephone"),p=$("#u-client-job"),m=$("#u-client-job-telephone"),f=$("#u-client-salary");l.val(n.nombres),o.val(n.apellidos),r.val(n.cedula),c.val(n.celular),s.val(n.provincia),i.val(n.sector),d.val(n.calle),u.val(n.casa),v.val(n.telefono),p.val(n.lugar_trabajo),m.val(n.tel_trabajo),f.val(n.salario),$("#update-client-modal").modal(),$("#btn-update-client").on("click",function(){a()})},saveObservations:function(e){var a,n,t,l,o,r;n=$("#text-observations").val(),o=$("#input-abono"),t=e?0:o.val(),l=$("#detail-client-id").val(),r=$(".abono-value"),void 0!=e?(o.val(t),$(".abono-box").removeClass("have-abono"),e=1):(o.attr("disabled"),$(".abono-box").addClass("have-abono"),e=0),a="observaciones="+n+"&abonos="+t+"&id_cliente="+l+"&modo="+e,a+="&tabla=observaciones",connectAndSend("process/update",!0,initPaymentsHandlers,null,a,null),r.find("input").val("RD$ "+CurrencyFormat(t))}},Generals={deleteRow:function(e,a){var n,t,l="tabla="+a+"&id="+e;switch(a){case"clientes":n=initClientHandlers,t=Clients.getLastPage;break;case"servicios":n=initServicesHandlers,t=Services.getAll}connectAndSend("process/delete",!0,n,null,l,t)},paginate:function(e,a,n){var t,l="user/";switch("users"!=n&&(l="process/"),tableFill=fillCurrentTable,n){case"users":t=initAdminHandlers;break;case"clientes":t=initClientHandlers;break;case"servicios":t=initServicesHandlers;break;case"v_contratos":t=initContractHandlers;break;case"pagos_por_contrato":t=initPaymentsHandlers;break;case"caja":t=initCajaHandlers,tableFill=fillCajaTable}var o="table="+n+"&offset="+e+"&perpage="+a;connectAndSend(l+"paginate",!1,t,tableFill,o,null)},search:function(e,a,n,t){void 0==t&&(t=initClientHandlers),void 0==n&&(n=fillCurrentTable);var l=e;if(null!=l||""!=l){var o="tabla="+a+"&word="+l;connectAndSend("process/search",!1,t,n,o,null)}},count_table:function(e){var a="tabla="+e,n=updateCount;"caja"==e&&(n=updateCajaCount),connectAndSend("process/count",!1,null,n,a,null)}},Services={add:function(){var e,a,n,t,l;a=$("#service-name").val(),n=$("#service-description").val(),t=$("#service-monthly-payment").val(),l=$("#service-type").val(),isEmpty([a,n,t,l])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="nombre="+a+"&descripcion="+n+"&mensualidad="+t+"&tipo="+l,e+="&tabla=servicios",connectAndSend("process/add",!0,initServicesHandlers,null,e,Services.getLastPage))},getAll:function(){connectAndSend("process/getall",!1,initServicesHandlers,fillCurrentTable,"tabla=servicios",null)},getLastPage:function(){connectAndSend("process/lastpage",!1,initServicesHandlers,fillCurrentTable,"tabla=servicios",null)},update:function(){var e,a,n,t,l,o;a=$("#u-service-id").val(),n=$("#u-service-name").val(),t=$("#u-service-description").val(),l=$("#u-service-monthly-payment").val(),o=$("#u-service-type").val(),isEmpty([a,n,t,l,o])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="id_servicio="+a+"&nombre="+n+"&descripcion="+t+"&mensualidad="+l,e+="&tipo="+o+"&tabla=servicios",connectAndSend("process/update",!0,initServicesHandlers,null,e,Services.getAll,heavyLoad))}},Contracts={add:function(){var e,a,n,t,l,o,r,c,s,i,d,u,v,p,m;a=$("#contract-client-id").val(),n=$("#contract-user-id").val(),t=$(".service-card.selected").attr("data-id"),o=$("#contract-client-date").val(),c=$("#contract-client-months").val(),s=$("#contract-equipment").val(),i=$("#contract-e-mac").val(),d=$("#contract-router").val(),u=$("#contract-r-mac").val(),p=$("#contract-equipment-model").val(),m=$("#contract-ip").val(),l=$("#select-contract-code").val(),r=$("#contract-client-payment").val(),v=moment(o).add(1,"months").format("YYYY-MM-DD"),isEmpty([a,n,t,o,c])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="id_empleado="+n+"&id_cliente="+a+"&id_servicio="+t+"&codigo="+l+"&fecha="+o,e+="&duracion="+c+"&monto_total="+(Number(c)+1)*Number(r)+"&monto_pagado=0&ultimo_pago=null",e+="&mensualidad="+r+"&proximo_pago="+v+"&estado=activo&tabla=contratos",e+="&nombre_equipo="+s+"&mac_equipo="+i+"&router="+d+"&mac_router="+u,e+="&modelo="+p+"&ip="+m,connectAndSend("process/add",!0,null,null,e,Contracts.getLast))},extend:function(e){var a;a="id_contrato="+idContrator,connectAndSend("process/extend",!0,initContractHandlers,null,a,null)},getLastPage:function(){connectAndSend("process/lastpage",!1,initContractHandlers,fillCurrentTable,"tabla=contratos",null)},getLast:function(e){$("#btn-save-contract").attr("disabled",""),$("#btn-print-contract").removeAttr("disabled");var a="tabla=pagos&id_contrato="+e;connectAndSend("process/getlist",!1,initContractHandlers,makePaymentList,a,null)},callExtra:function(){var e=$("tr.selected");if(void 0!=e){var a=e.find("td.th-client").attr("data-cedula");$("#extra-client-dni").val(a),Contracts.getAllOfClient(a),$("#add-extra-modal").modal()}else displayAlert("Revise","Seleccione el conrato primero","error")},cancel:function(){var e,a=$("tr.selected"),n=a.find(".id_contrato").text().trim(),t=a.find(".th-client").attr("data-id-cliente"),l=!1,o=$("#cancelation-reason").val(),r=$("#check-penalty:checked").length;n?(r>0&&(l=!0),e="id_contrato="+n+"&fecha="+moment().format("YYYY-MM-DD")+"&id_cliente="+t,e+="&motivo="+o+"&penalidad="+l,connectAndSend("process/cancel",!0,null,null,e,Contracts.getLastPage)):displayMessage(MESSAGE_ERROR+" No hay contrato seleccionado")},getOne:function(e,a){form="tabla=contratos&id_contrato="+e,connectAndSend("process/getone",!1,initContractHandlers,a,form,null)},recieve:function(e){function a(){var e=$("#check-change-ip:checked").length;form="id_contrato="+t+"&nombre_equipo="+l.val()+"&mac_equipo="+o.val(),form+="&router="+r.val()+"&mac_router="+c.val(),form+="&modelo="+s.val(),form+="&tabla=contratos",e>0&&(form+="&ip="+d.val()+"&codigo="+i.val()),connectAndSend("process/update",!0,initContractHandlers,null,form,Contracts.getLastPage)}var n=JSON.parse(e),t=n.id_contrato,l=$("#u-contract-equipment"),o=$("#u-contract-e-mac"),r=$("#u-contract-router"),c=$("#u-contract-r-mac"),s=$("#u-contract-modelo"),i=$("#select-contract-code"),d=($("#check-change-ip"),$("#u-contract-ip"));l.val(n.nombre_equipo),o.val(n.mac_equipo),r.val(n.router),c.val(n.mac_router),s.val(n.modelo),d.val(n.ip),$("#update-contract-modal").modal(),$("#update-contract").on("click",function(e){e.stopImmediatePropagation(),a()})},getIpList:function(){function e(e){$("#select-contract-code").html(e)}var a="id_seccion="+$("#select-contract-sector").val()+"&tabla=ip_list";connectAndSend("process/getall",!1,null,e,a,null)},btnExtraPressed:function(e){switch(e.text().trim().toLowerCase()){case"mejorar":Contracts.upgrade();break;case"extender":Contracts.extend();break;case"guardar":Contracts.addExtra()}},upgrade:function(){var e,a,n,t,l;a=$("#extra-client-contract").val(),t=(n=$(".service-card.selected")).attr("data-id"),l=n.attr("data-payment"),isEmpty([a,t,l])?displayAlert("Revise","asegurate de llenar todos los datos y seleccionar el servicio","info"):(e="id_contrato="+a+"&id_servicio="+t+"&cuota="+l,connectAndSend("process/upgrade",!0,initGlobalHandlers,null,e,Contracts.getLastPage))},addExtra:function(){var e,a,n,t,l,o,r,c;a=$("#extra-client-contract").val(),t=$("#extra-service-cost").val(),n=$("#select-extra-service").val(),l=$("#extra-equipo").val(),o=$("#extra-e-mac").val(),r=$("#extra-router").val(),c=$("#extra-r-mac").val(),isEmpty([a,n,t])?displayAlert("revise","asegurate de llenar todos los datos y seleccionar el servicio","info"):(e="id_contrato="+a+"&costo_servicio="+t+"&nombre_servicio="+n,e+="&nombre_equipo="+l+"&mac_equipo="+o+"&router="+r+"&mac_router="+c,connectAndSend("process/addextra",!0,initGlobalHandlers,null,e,Contracts.getLastPage))},extend:function(){var e,a,n;a=$("#extra-client-contract").val(),n=$("#extra-extension-months").val(),isEmpty([n,a])?displayAlert("revise","asegurate de llenar todos los datos y seleccionar el servicio","info"):(e="id_contrato="+a+"&duracion="+n,connectAndSend("process/extend_contract",!0,initGlobalHandlers,null,e,Contracts.getLastPage))},getAllOfClient:function(e){var a="dni="+e;connectAndSend("process/data_for_extra",!1,null,makeContractList,a,null)}},Payments={getAll:function(){var e=$("#select-contract").val();if(null!=e){var a="tabla=pagos&id="+e;connectAndSend("process/getall",!1,initPaymentsHandlers,fillCurrentTable,a,null)}},getLastPage:function(){connectAndSend("process/lastpage",!1,initPaymentsHandlers,fillCurrentTable,"tabla=pagos",null)},update:function(e){if(0==$("#input-abono").val()){var a="tabla=pagos&id="+e+"&estado=pagado&fecha_pago="+moment().format("YYYY-MM-DD")+"&id_contrato="+$("#select-contract").val();connectAndSend("process/update",!0,initPaymentsHandlers,null,a,Payments.getLastPage)}else displayAlert("Favor Leer","has click en la zona roja de abono para confirmar que le viste antes de registrar el pago","info")},updateUntil:function(e,a){$("#select-contract").val();var n="tabla=pagos_al_dia&id_ultimo_pago="+a+"&estado=pagado&id_contrato="+e;connectAndSend("process/update",!0,null,null,n,null,heavyLoad)}},Damages={add:function(){var e,a,n;a=$("#averias-client-id").val(),n=$("#a-description").val(),isEmpty([a,n])?displayAlert("Revise","LLene todos los campos por favor","error"):(e="id_cliente="+a+"&descripcion="+n+"&tabla=averias",connectAndSend("process/add",!0,initGlobalHandlers,null,e,Damages.getAll)),$("#new-averia-modal").find("input,textarea").val("")},getAll:function(){var e=$("#averias-view-mode").val();$(".presentado").text(e);var a="tabla=averias&estado="+e;connectAndSend("process/getall",!1,initGlobalHandlers,fillAveriasList,a,null)},update:function(e){var a="tabla=averias&id_averia="+e;connectAndSend("process/update",!0,initGlobalHandlers,null,a,Damages.getAll)}},Installations={getAll:function(){var e="tabla=instalaciones&estado="+$("#installations-view-mode").val();connectAndSend("process/getall",!1,initGlobalHandlers,fillInstallationsList,e,null)},update:function(e){var a="tabla=instalaciones&id_pago="+e;connectAndSend("process/update",!0,initGlobalHandlers,null,a,Installations.getAll)}},Caja={add:function(){var e,a,n;e="entrada="+(a=$("#caja-a-amount").val())+"&descripcion="+(n=$("#caja-a-description").val())+"&tabla=caja",isEmpty([a,n])?displayAlert("Revise","LLene todos los campos por favor","error"):connectAndSend("process/add",!0,initCajaHandlers,null,e,Caja.getLastPage)},retire:function(){var e,a,n;e="salida="+(a=$("#caja-r-amount").val())+"&descripcion="+(n=$("#caja-r-description").val()),isEmpty([a,n])?displayAlert("Revise","LLene todos los campos por favor","error"):connectAndSend("process/retire",!0,initCajaHandlers,null,e,Caja.getLastPage)},getLastPage:function(){connectAndSend("process/lastpage",!1,initCajaHandlers,fillCajaTable,"tabla=caja",Caja.getSaldo)},getSaldo:function(){connectAndSend("process/getone",!1,initCajaHandlers,updateSaldo,"tabla=caja",null)},search:function(){var e=$("#caja-date"),a=$("#caja-user"),n=e.val()?e.val():"%",t="tabla=caja&id_empleado="+(a.val()?a.val():"%")+"&fecha="+n;connectAndSend("process/search",!1,initCajaHandlers,fillCajaTable,t,null)}},Company={update:function(){var e,a=$("#company-name").val(),n=$("#company-statement").val(),t=$("#company-phone1").val(),l=$("#company-direction").val();e="nombre="+a+"&lema="+n+"&descripcion="+$("#company-description").val()+"&direccion=",e+=l+"&telefono1="+t+"&telefonos="+$("#company-phone2").val()+"&tabla=empresa",connectAndSend("process/update",!0,null,null,e,null)}},Settings={update:function(){var e;e="cargo_mora="+$("#settings-mora").val()+"&fecha_corte="+$("#settings-fecha-corte").val()+"&apertura_caja="+$("#settings-apertura-caja").val(),e+="&penalizacion_cancelacion="+$("#settings-penalizacion-cancelacion").val()+"&meses_por_defecto="+$("#settings-meses-por-defecto").val(),e+="&split_day="+$("#settings-split-day").val()+"&tabla=settings",connectAndSend("process/update",!0,null,null,e,null)}},Sections={add:function(){function e(e){var a="nombre="+e[0]+"&codigo_area="+e[1];return a+="&tabla=secciones",new Promise(function(e){if(connectAndSend("process/add",!0,!1,null,a,Sections.getAll,heavyLoad))return e()})}swal.setDefaults({input:"text",confirmButtonText:"Next &rarr;",showCancelButton:!0,animation:!1,progressSteps:["1","2","3"]});var a=[{title:"Nombre del sector"},"Codigo del Sector"];swal.queue(a).then(function(a){swal.resetDefaults(),e(a)})},getIps:function(){var e=$("#select-sector").val();if(null!=e){var a="tabla=ips&id="+e;connectAndSend("process/getall",!1,null,Sections.reorderTable,a,null)}},reorderTable:function(e){var a=$("#t-sections");a.bootstrapTable("destroy"),$("#t-sections tbody").html(e),a.bootstrapTable()},getAll:function(){function e(e){$("#select-sector").html(e)}connectAndSend("process/getall",!1,null,e,"tabla=secciones",heavyLoad)}};